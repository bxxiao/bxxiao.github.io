<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>MySQL基础笔记 | bxxiao</title><meta name="keywords" content="MySQL"><meta name="author" content="bxxiao"><meta name="copyright" content="bxxiao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="概述​        MySQL很牛逼。 MySQL是属于C&#x2F;S架构的软件。 MySQL的优点：可将数据持久化到本地；可用sql语言进行查询，便于管理。  MySQL的卸载及安装MySQL卸载MySQL的卸载：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV12b411K7Zu?p&#x3D;249  第6集 MySQL8.0.22的安装https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_4">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基础笔记">
<meta property="og:url" content="http://example.com/2020/07/17/MySQL%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="bxxiao">
<meta property="og:description" content="概述​        MySQL很牛逼。 MySQL是属于C&#x2F;S架构的软件。 MySQL的优点：可将数据持久化到本地；可用sql语言进行查询，便于管理。  MySQL的卸载及安装MySQL卸载MySQL的卸载：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV12b411K7Zu?p&#x3D;249  第6集 MySQL8.0.22的安装https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_4">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/bxgitee/noteImage/raw/master/image/ball_glass_sunset_133830_1920x1080.jpg">
<meta property="article:published_time" content="2020-07-17T14:19:23.000Z">
<meta property="article:modified_time" content="2020-11-26T13:55:30.666Z">
<meta property="article:author" content="bxxiao">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/bxgitee/noteImage/raw/master/image/ball_glass_sunset_133830_1920x1080.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2020/07/17/MySQL%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-11-26 21:55:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/zfe-2.0@1.15/css/cardlistpost.css"/><meta name="referrer" content="no-referrer-when-downgrade" /><meta name="generator" content="Hexo 5.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://gitee.com/bxgitee/noteImage/raw/master/image/567.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/Tag/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/Tag/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://gitee.com/bxgitee/noteImage/raw/master/image/blogImagec.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">bxxiao</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/Tag/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">MySQL基础笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-07-17T14:19:23.000Z" title="发表于 2020-07-17 22:19:23">2020-07-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-11-26T13:55:30.666Z" title="更新于 2020-11-26 21:55:30">2020-11-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL/">MySQL</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>​        MySQL很牛逼。</p>
<p><strong><span style="color:red">MySQL是属于C/S架构的软件</span></strong>。</p>
<p>MySQL的优点：可将数据持久化到本地；可用sql语言进行查询，便于管理。</p>
<hr>
<h2 id="MySQL的卸载及安装"><a href="#MySQL的卸载及安装" class="headerlink" title="MySQL的卸载及安装"></a>MySQL的卸载及安装</h2><h3 id="MySQL卸载"><a href="#MySQL卸载" class="headerlink" title="MySQL卸载"></a>MySQL卸载</h3><p>MySQL的卸载：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV12b411K7Zu?p=249">https://www.bilibili.com/video/BV12b411K7Zu?p=249</a>  第6集</p>
<h3 id="MySQL8-0-22的安装"><a href="#MySQL8-0-22的安装" class="headerlink" title="MySQL8.0.22的安装"></a>MySQL8.0.22的安装</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43715354/article/details/109354222">https://blog.csdn.net/qq_43715354/article/details/109354222</a></p>
<p>按照该教程至第八步。</p>
<ul>
<li><p>启动cmd。</p>
</li>
<li><p>输入<code>mysql -u root -p</code> </p>
</li>
<li><p>输入上述随机生成的密码进入数据库。进入后需要修改密码，因为随机生成的密码在登录后会过期。（这时若不修改密码，执行一切sql语句都会报错，提醒修改密码）</p>
</li>
<li><p>修改密码的命令：</p>
<ul>
<li><p><code>alter user &#39;root&#39;@&#39;localhost&#39; identified by &#39;newPassword&#39;;</code> </p>
</li>
<li><p><code>flush privileges;</code> </p>
</li>
</ul>
</li>
</ul>
<h3 id="my-ini文件"><a href="#my-ini文件" class="headerlink" title="my.ini文件"></a>my.ini文件</h3><p>MySQL的安装目录下的<code>my.ini</code>文件是MySQL的配置文件，在其中可配置相关信息（#开头的为注释），其中的<code>[mysqld]</code>下可配置服务端的相关信息，如下：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment"># 设置3306端口</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"><span class="comment"># 设置mysql的安装目录</span></span><br><span class="line"><span class="attr">basedir</span>=D:\\Program Files\MySQL\mysql-<span class="number">8.0</span>.<span class="number">22</span></span><br><span class="line"><span class="comment"># 设置mysql数据库的数据的存放目录</span></span><br><span class="line"><span class="attr">datadir</span>=D:\\Program Files\MySQL\mysql-<span class="number">8.0</span>.<span class="number">22</span>\data</span><br><span class="line"><span class="comment"># 允许最大连接数</span></span><br><span class="line"><span class="attr">max_connections</span>=<span class="number">200</span></span><br><span class="line"><span class="comment"># 允许连接失败的次数。</span></span><br><span class="line"><span class="attr">max_connect_errors</span>=<span class="number">10</span></span><br><span class="line"><span class="comment"># 服务端使用的字符集默认为utf8mb4</span></span><br><span class="line"><span class="attr">character-set-server</span>=utf8mb4</span><br><span class="line"><span class="comment"># 创建新表时将使用的默认存储引擎</span></span><br><span class="line"><span class="attr">default-storage-engine</span>=INNODB</span><br><span class="line"><span class="comment"># 默认使用“mysql_native_password”插件认证</span></span><br><span class="line"><span class="comment">#mysql_native_password</span></span><br><span class="line"><span class="attr">default_authentication_plugin</span>=mysql_native_password</span><br><span class="line"><span class="section">[mysql]</span></span><br><span class="line"><span class="comment"># 设置mysql客户端默认字符集</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8mb4</span><br><span class="line"><span class="section">[client]</span></span><br><span class="line"><span class="comment"># 设置mysql客户端连接服务端时默认使用的端口</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8mb4</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="MySQL服务的启动和关闭"><a href="#MySQL服务的启动和关闭" class="headerlink" title="MySQL服务的启动和关闭"></a>MySQL服务的启动和关闭</h2><p>可通过</p>
<p><strong>【右键我的电脑】-》【管理】-》【服务和应用程序】-》【服务】-》【找到MySQL】-》【双击，选择启动/关闭】</strong> </p>
<p>或者：</p>
<p><strong>以【管理员身份运行命令行】-》【输入命令<code>net stop/start mysqlServerName</code>】</strong> </p>
<hr>
<h2 id="登录MySQL及环境变量"><a href="#登录MySQL及环境变量" class="headerlink" title="登录MySQL及环境变量"></a>登录MySQL及环境变量</h2><h3 id="登录MySQL"><a href="#登录MySQL" class="headerlink" title="登录MySQL"></a>登录MySQL</h3><p>​        可通过MySQL自带的命令行（只能登录root用户）。</p>
<p>​        也可通过命令行：</p>
<p>​        <code>mysql -h localhost -P 3306 -u root -p </code> </p>
<p>​        <code>mysql -h localhost -P 3306 -u root -padmin</code> （<strong>用于连接远程</strong>）</p>
<p>​        <code>mysql -u root -pPassword</code> （<strong>连接本地MySQL</strong>）</p>
<h3 id="MySQL环境变量"><a href="#MySQL环境变量" class="headerlink" title="MySQL环境变量"></a>MySQL环境变量</h3><p>​        若以上命令不可用，可能原因是没有配置环境变量（<strong>若是使用msi安装包安装则MySQL会自动配置</strong>）。</p>
<p>​        手动配置过程：在<code>Path</code>环境变量中添加MySQL的安装目录中的bin目录路径即可。</p>
<hr>
<h2 id="MySQL语法规范及常用命令"><a href="#MySQL语法规范及常用命令" class="headerlink" title="MySQL语法规范及常用命令"></a>MySQL语法规范及常用命令</h2><h3 id="语法规范"><a href="#语法规范" class="headerlink" title="语法规范"></a>语法规范</h3><ul>
<li>MySQL中的<strong>命令以<code>;</code>或<code>\g</code>结束</strong>。</li>
<li>MySQL命令不区分大小写。</li>
<li>注释<ul>
<li>单行注释：<code>#注释</code>或<code>-- 注释</code>(空格必需)</li>
<li>多行注释：<code>/* 注释 */</code> </li>
</ul>
</li>
</ul>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><p>进入MySQL后，可使用以下相关命令：</p>
<p>显示所有数据库：<strong><code>show databases;</code></strong> </p>
<p><code>----------------------------------</code> </p>
<p>使用指定数据库：<strong><code>use dababaseName;</code> </strong></p>
<p><code>----------------------------------</code>   </p>
<p>显示当前数据库中的所有表：<strong><code>show tables;</code> </strong></p>
<p><code>----------------------------------</code> </p>
<p>显示指定数据库的所有表（<strong>使用该命令后，当前数据库位置不变</strong>）：<strong><code>show tables from databaseName</code> </strong></p>
<p><code>----------------------------------</code> </p>
<p>查看表结构：<strong><code>desc tableName</code> </strong> </p>
<p><code>----------------------------------</code> </p>
<p>查看MySQL版本：</p>
<p>在MySQL中：<strong><code>select version();</code> </strong> </p>
<p>在MySQL外：<strong><code>mysql --version</code>或<code>mysql -V</code> </strong> </p>
<p><code>----------------------------------</code> </p>
<h2 id="MySQL基础-DQL"><a href="#MySQL基础-DQL" class="headerlink" title="MySQL基础-DQL"></a>MySQL基础-DQL</h2><p>tips：**该笔记的实例代码中的数据库是<code>myemploees</code>**。</p>
<p>SQL语言的分类：</p>
<ul>
<li>DQL（Data Query Language）：数据查询语言。</li>
<li>DML（Data Management Language）：数据操作语言，修改表的语言，如插入、修改、删除语句。</li>
<li>DDL（Data Definition Language）：数据定义语言，如创建表、创建库。</li>
<li>TCL（Translation Control Language）：事物控制语言。</li>
</ul>
<h3 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h3><p><strong>tips：字符型、日期型的值用单引号括起来。</strong> </p>
<p>查询表中字段：<code>select queryList from tableName;</code> </p>
<p>查询所有字段：<code>select * from tableName;</code> </p>
<p>查询常量：<code>select 100;</code>或  <code>select &#39;string&#39;;</code> </p>
<p>查询表达式：<code>select 100*90;</code> </p>
<p>查询函数：<code>select version();</code> </p>
<p><code>-----------------------------------------------</code> </p>
<p>起别名（别名可用于字段名重复的情况）：</p>
<p><code>SELECT first_name AS 姓,last_name AS 名 FROM employees</code> </p>
<p>或</p>
<p><code>SELECT first_name 姓,last_name 名 FROM employees;</code> </p>
<p><code>SELECT salary AS &#39;out put&#39; FROM employees;</code></p>
<p><code>-----------------------------------------------</code> </p>
<p>去重：<code>SELECT DISTINCT job_id FROM employees</code> </p>
<p><code>-----------------------------------------------</code> </p>
<p>SQL中的+号：</p>
<p><strong>两个运算数都是数值型，作加法运算</strong>：<code>select 100+10;</code> </p>
<p><strong>有一个是字符串，则试图转化字符串为数字，若是转化失败则化为0</strong>：</p>
<p><code>select &#39;123&#39;+10;</code>  //133</p>
<p><code>select &#39;string&#39;+10;</code>  //0</p>
<p><code>SELECT 10 + &#39;10sdfef3s&#39; + 10;</code>若字符串的前端有数字，会进行转换，此处查询结果为10+10+10=30</p>
<p><strong>若有运算数为null，则结果为null</strong>：<code>select null+10;</code>  </p>
<p><strong>SQL中的+号没有字符串拼接功能，要拼接字符使用<code>concat()</code>函数</strong>：</p>
<p><code>SELECT CONCAT(last_name,first_name) AS 姓名 FROM employees</code> </p>
<p><code>-----------------------------------------------</code> </p>
<h3 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h3><p><strong>条件查询语句</strong>：<strong><code>select 查询列表 from tableName where condition;</code></strong> </p>
<p>其中，<strong><span style="color:red;">筛选条件顺序为：tableName -&gt; condition -&gt; 查询列表</span></strong>。</p>
<h4 id="按条件表达式筛选"><a href="#按条件表达式筛选" class="headerlink" title="按条件表达式筛选"></a>按条件表达式筛选</h4><p>包含这些运算符的表达式：<strong><code>&gt;  &lt;  =  !=  &lt;&gt;(建议)  &gt;=  &lt;=</code></strong>  </p>
<p>eg：</p>
<p><code>SELECT * FROM employees WHERE salary&gt;12000;</code> </p>
<p><code>SELECT last_name, first_name FROM employees WHERE department_id&lt;&gt;20;</code> </p>
<h4 id="按逻辑表达式筛选"><a href="#按逻辑表达式筛选" class="headerlink" title="按逻辑表达式筛选"></a>按逻辑表达式筛选</h4><p><strong><code>and or not</code>（建议）或<code>&amp;&amp;  || !</code></strong>  （<strong>连接条件表达式</strong>）</p>
<ul>
<li><p><code>SELECT last_name, salary, commission_pct </code> </p>
<p><code>FROM employees </code> </p>
<p><code>WHERE salary&gt;=10000 AND salary&lt;=20000;</code> </p>
</li>
<li><p><code>SELECT * FROM employees</code><br><code>WHERE NOT(department_id&gt;=90 AND department_id&lt;=110) OR salary&gt;15000;</code> </p>
</li>
</ul>
<h4 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h4><p><span style="font-size:20px;"><code>like</code></span>    </p>
<p><code>like</code>一般与通配符配合使用，如下：</p>
<ul>
<li><code>%</code>：表示任意多个字符，包括空字符。</li>
<li><code>_</code>：表示一个字符。</li>
</ul>
<p>eg：</p>
<p><code>SELECT * FROM employees WHERE last_name LIKE &#39;%a%&#39;;</code> </p>
<p><code>SELECT last_name,salary FROM employees WHERE last_name LIKE &#39;__t_b%&#39;;</code> </p>
<p>当需要查询包含通配符的字段，需要使用转义字符<code>\</code>，<strong>也可通过<code>escape</code>自定义转移字符</strong>。</p>
<p>eg：</p>
<p>查询last_name中第二个字符是_的字段：<strong><code>SELECT last_name FROM employees WHERE last_name LIKE &#39;_\_%&#39;;</code></strong> </p>
<p>或：<strong><code>SELECT last_name FROM employees WHERE last_name LIKE &#39;_$_%&#39; ESCAPE &#39;#39;;</code></strong>  </p>
<p><strong><span style="color:red;">like也可用于筛选int类型值</span></strong>，eg：</p>
<p><code>SELECT * FROM employees WHERE department_id LIKE &#39;1__&#39;;</code> </p>
<p><code>-------------------------------------------------------------------------------------</code> </p>
<p><span style="font-size:20px;"><strong><code>（not） between and</code></strong></span> （<strong>左右为闭区间</strong>） </p>
<p>代替<code>where value1&gt;= 100 and value1&lt;=120;</code>，<strong>代码更整洁</strong>。</p>
<p>eg：</p>
<p><code>SELECT * FROM employees WHERE employee_id BETWEEN 100 AND 120;</code> </p>
<p><code>-------------------------------------------------------------------------------------</code> </p>
<p><span style="font-size:20px;"><code>in </code></span>   </p>
<p>若字段的值等于in列表内的任一值即满足条件。其中，<strong><span style="color:red">in列表中的值必须为同一类型或可兼容</span></strong>（如’123’可等于123），<strong>且不支持通配符</strong>。</p>
<p>eg：</p>
<p><code>SELECT last_name,job_id FROM employees WHERE job_id IN(&#39;IT_PROG&#39;,&#39;AD_VP&#39;);</code> </p>
<p><code>-------------------------------------------------------------------------------------</code> </p>
<p><span style="font-size:20px;"><code> is （not） null</code> </span></p>
<p>**MySQL中的=，&lt;&gt;不能比较字段值跟null，只能用<code>is null</code>或<code>is not null</code>**。eg：</p>
<p><code>SELECT last_name,commission_pct FROM employees WHERE commission_pct IS NOT NULL;</code> </p>
<p><strong>MySQL中，有安全等与符号：<code>&lt;=&gt;</code> ，可用于普通值间的比较跟null值的比较</strong>。</p>
<p>eg：</p>
<p><code>SELECT last_name,commission_pct FROM employees WHERE commission_pct &lt;=&gt; NULL;</code> </p>
<h3 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h3><p><strong>排序查询语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> queryList</span><br><span class="line"><span class="keyword">from</span> tableName</span><br><span class="line"><span class="keyword">where</span> condition</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 排序列表名 <span class="keyword">asc</span>|<span class="keyword">desc</span>;  <span class="comment"># asc 升序；desc 降序，默认为asc</span></span><br></pre></td></tr></table></figure>

<p><strong>order by的排序列表可用别名、单个字段、多个字段、函数及表达式</strong>。</p>
<p>eg：</p>
<p>工资降序：</p>
<p><code>SELECT * FROM employees ORDER BY salary DESC;</code> </p>
<p>全部信息，年薪降序：</p>
<p><code>SELECT *,salary*12*(1+IFNULL(commission_pct,0)) yearSalary FROM employees ORDER BY yearSalary DESC;</code></p>
<p><strong>按多个字段排序</strong>：其中，<strong><span style="color:red">先将salary升序排序，再在每个salary相同的区间内，对这些记录的employee_id进行降序排序</span></strong>。</p>
<p><code>SELECT * FROM employees ORDER BY salary ASC,employee_id DESC;</code></p>
<hr>
<h3 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h3><p><strong>分组查询使用<code>group by</code>关键字，配合分组函数</strong>，<strong><span style="color:red">根据条件将记录分为若干组</span></strong>。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只有出现在group by后的列才能位于查询列表；下列的数字为语句执行顺序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">colum</span>,groupFunction(<span class="keyword">colum</span>)   <span class="comment">#5</span></span><br><span class="line"><span class="keyword">FROM</span> tableName  <span class="comment">#1（把整个表拿出来）</span></span><br><span class="line">[<span class="keyword">WHERE</span> condition]  <span class="comment">#2</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> expr  <span class="comment">#3</span></span><br><span class="line">[<span class="keyword">HAVING</span> condition2]  <span class="comment">#4</span></span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">colum</span>]  <span class="comment">#6</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​        其中，<strong>若有where字句，则必须放在from后；且<span style="color:red">只有出现在group by后的列（字段）才能位于查询列表</span>，<span style="color:red">其中，数字为底层执行顺序</span></strong>。<strong>分组函数将根据<code>GROUP BY</code>的分组情况分别作用于每一组</strong>。</p>
<p>​        一般不在having子句使用别名，原因是Oracle等数据库不支持，不使用别名从而有更好的通用性。</p>
<p>例子：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#每个工种的最高工资</span></span><br><span class="line"><span class="keyword">SELECT</span> job_id,<span class="keyword">MAX</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">#每个位置上的部门个数</span></span><br><span class="line"><span class="keyword">SELECT</span> location_id,<span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> departments <span class="keyword">GROUP</span> <span class="keyword">BY</span> location_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加分组前的筛选</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>为分组查询添加筛选条件：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查询邮箱中带有a的，每个部门的平均工资</span></span><br><span class="line"><span class="keyword">SELECT</span> department_id,<span class="keyword">AVG</span>(salary) 平均工资 </span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> email <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id;</span><br></pre></td></tr></table></figure>

<h4 id="分组后筛选-having子句"><a href="#分组后筛选-having子句" class="headerlink" title="分组后筛选(having子句)"></a>分组后筛选(<code>having</code>子句)</h4><p>​        上述的有筛选条件的分组查询都是<strong>分组前的筛选</strong>，即在原始表上进行筛选。</p>
<p>​        有时需要对分组的后的结果再添加筛选条件（<strong>分组后的筛选</strong>），<strong>即对分组查询的结果集再添加筛选条件</strong>，这时<strong>where子句不能满足</strong>需求，<strong>需使用<code>having</code>子句，放在<code>group by</code>后面</strong>。</p>
<p>如下：</p>
<ul>
<li>例1中，先按部门id分组，查询出部门id和每个部门的员工个数，再在该查询基础上，使用having子句添加员工个数&gt;2的筛选条件。</li>
<li>例2分析见注释。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#添加分组后的筛选</span></span><br><span class="line"><span class="comment">#1.查询员工个数大于2的部门</span></span><br><span class="line"><span class="keyword">SELECT</span> department_id,<span class="keyword">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*)&gt;<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.查询每个工种有奖金的员工的最高工资&gt;12000的 的工种编号和最高工资</span></span><br><span class="line"><span class="comment">#对题目解析：</span></span><br><span class="line"><span class="comment">#查询每个工种(group by)有奖金(comm.. is not null，分组前，即可在原始表上进行筛选)的员工的</span></span><br><span class="line"><span class="comment">#最高工资(max salary)&gt;12000(having,即分组后）的 的工种编号和最高工资</span></span><br><span class="line"><span class="keyword">SELECT</span> job_id,<span class="keyword">MAX</span>(salary) <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">MAX</span>(salary)&gt;<span class="number">12000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.查询领导编号大于102的领导手下员工的最低工资&gt;5000 的领导编号和最低工资</span></span><br><span class="line"><span class="keyword">SELECT</span> manager_id,<span class="keyword">MIN</span>(salary) <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> manager_id&gt;<span class="number">102</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> manager_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">MIN</span>(salary)&gt;<span class="number">5000</span>;</span><br><span class="line">                        </span><br></pre></td></tr></table></figure>

<p>分组条件也可以是函数或其他表达式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按表达式或函数分组</span></span><br><span class="line"><span class="comment">#1.按员工姓名的长度分组，查询每一组的员工个数，并筛选出员工个数长度大于5的</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LENGTH</span>(last_name) name_len,<span class="keyword">COUNT</span>(*) c <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name_len</span><br><span class="line"><span class="keyword">HAVING</span> c&gt;<span class="number">5</span>;</span><br></pre></td></tr></table></figure>



<p><strong>按多个字段分组</strong>：<strong><span style="color:red;">按多个字段分组的最终结果其实就是：各分组字段值都一样的若干记录为一组</span>，分组函数再根据分组情况作用于每一组。若把分组的字段顺序改变，其结果将一样</strong>。。</p>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.查询每个部门中，每个工种的员工平均工资</span></span><br><span class="line"><span class="keyword">SELECT</span> department_id,job_id,<span class="keyword">AVG</span>(salary) <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id,job_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.按平均工资降序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> job_id,department_id,<span class="keyword">AVG</span>(salary) <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id,department_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">AVG</span>(salary) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>



<p>​        综上，分组查询的筛选条件分为分组前筛选跟分组后筛选，如下表</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">数据源</th>
<th align="center">位置</th>
<th align="center">关键字</th>
</tr>
</thead>
<tbody><tr>
<td align="center">分组前筛选</td>
<td align="center">原始表</td>
<td align="center">group by子句前</td>
<td align="center">where</td>
</tr>
<tr>
<td align="center">分组后筛选</td>
<td align="center">分组后的结果集</td>
<td align="center">group by子句后</td>
<td align="center">having</td>
</tr>
</tbody></table>
<p>其中，对分组函数做条件必须放在having子句中；能用分组前筛选则优先使用分组前筛选。</p>
<hr>
<h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3><p>（sql99标准）</p>
<p>​        当查询对象来自多个表时，需要用到连接查询。当<strong>连接查询没有添加任何限制时，将会发送笛卡尔积现象</strong>，即若表1有12行，表2有4行，查询结果将会有12*4=48行。</p>
<p>​        <strong><span style="color:red;">多表查询的结果可按以下思路：先查询出笛卡尔积结果，再根据where子句的条件进行筛选</span></strong>。</p>
<p>​        <strong>连接查询按功能可分为</strong>：</p>
<ul>
<li>内连接 <strong>inner</strong>（连接类型关键字可省略） <ul>
<li>等值连接 </li>
<li>非等值连接</li>
<li>自连接</li>
</ul>
</li>
<li>外连接<ul>
<li>左外连接 <strong>left [outer]</strong> </li>
<li>右外连接 <strong>right [outer]</strong> </li>
<li>全外连接（MySQL不支持）</li>
</ul>
</li>
<li>交叉连接 <strong>cross</strong> </li>
</ul>
<p><strong>连接查询的语法</strong>：</p>
<p>其中，<strong>连接类型关键字见上面功能分类</strong>。<strong>连接条件与筛选条件分开，可读性更高</strong>。#num表示执行顺序。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 查询列表 <span class="comment">#6</span></span><br><span class="line"><span class="keyword">from</span> table1 别名   <span class="comment">#1</span></span><br><span class="line">【连接类型关键字】<span class="keyword">join</span> table2 别名  <span class="comment">#2（笛卡尔积）</span></span><br><span class="line"><span class="keyword">on</span> 连接条件<span class="number">1</span></span><br><span class="line">【<span class="keyword">join</span> table3 别名 </span><br><span class="line"><span class="keyword">on</span> 连接条件<span class="number">2</span>】</span><br><span class="line">【<span class="keyword">where</span> 筛选条件】 <span class="comment">#3</span></span><br><span class="line">【<span class="keyword">group</span> <span class="keyword">by</span> 分组条件】 <span class="comment">#4</span></span><br><span class="line">【<span class="keyword">having</span> 分组后筛选】 <span class="comment">#5</span></span><br><span class="line">【<span class="keyword">order</span> <span class="keyword">by</span> ...】 <span class="comment">#7</span></span><br></pre></td></tr></table></figure>



<h4 id="内连接-等值连接"><a href="#内连接-等值连接" class="headerlink" title="内连接-等值连接"></a>内连接-等值连接</h4><p>其查询结果与sql92标准中的一致。inner关键字可以省略；<strong>多表（3以上）查询中，需保证前后两个表有连接条件</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.查询员工名以及对应的部门</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,d.department_id </span><br><span class="line"><span class="keyword">FROM</span> employees e </span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.<span class="string">`department_id`</span>=d.<span class="string">`department_id`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.名字包含e的员工名和工种名</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> jobs j</span><br><span class="line"><span class="keyword">ON</span> e.<span class="string">`job_id`</span>=j.<span class="string">`job_id`</span></span><br><span class="line"><span class="keyword">WHERE</span> e.<span class="string">`last_name`</span> <span class="keyword">LIKE</span> <span class="string">&#x27;%e%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.部门员工个数大于3的部门名以及对应员工个数，按个数降序</span></span><br><span class="line"><span class="keyword">SELECT</span> department_name,<span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> employees e</span><br><span class="line"><span class="keyword">ON</span> d.<span class="string">`department_id`</span>=e.<span class="string">`department_id`</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_name</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*)&gt;<span class="number">3</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">COUNT</span>(*) <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.员工名，部门名，工种名，按部门名降序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.<span class="string">`department_id`</span>=d.<span class="string">`department_id`</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> jobs j <span class="keyword">ON</span> e.<span class="string">`job_id`</span>=j.<span class="string">`job_id`</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_name;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="内连接-非等值连接"><a href="#内连接-非等值连接" class="headerlink" title="内连接-非等值连接"></a>内连接-非等值连接</h4><p><strong>非等值连接与等值连接的不同之处在于：where子句使用<code>=</code>以外的条件运算符</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#查询员工的工资跟工资等级（employees表跟job_grades表）</span><br><span class="line">SELECT last_name,salary,grade_level</span><br><span class="line">FROM employees e</span><br><span class="line">JOIN job_grades g</span><br><span class="line">ON salary BETWEEN lowest_sal AND highest_sal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#查询员工的工资等级及该等级的工资的员工个数</span><br><span class="line">SELECT grade_level,COUNT(*)</span><br><span class="line">FROM employees e</span><br><span class="line">JOIN job_grades g</span><br><span class="line">ON salary BETWEEN lowest_sal AND highest_sal</span><br><span class="line">GROUP BY grade_level;</span><br></pre></td></tr></table></figure>



<h4 id="内连接-自连接"><a href="#内连接-自连接" class="headerlink" title="内连接-自连接"></a>内连接-自连接</h4><p>自连接，顾名思义，即<strong>一个表连接它本身</strong>。适用的表的特点：<strong><span style="color:red;">表中有一个字段指向当前表的另一个字段</span></strong>。</p>
<p>查询员工名，对应的领导id跟领导名：（领导id指向员工名）</p>
<p><strong><span style="color:red;">此处为两个employees表起了两个别名</span></strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.<span class="string">`last_name`</span>,a.<span class="string">`manager_id`</span>,b.<span class="string">`last_name`</span> manager_name</span><br><span class="line"><span class="keyword">FROM</span> employees a,employees b</span><br><span class="line"><span class="keyword">WHERE</span> a.<span class="string">`manager_id`</span>=b.<span class="string">`employee_id`</span>;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.<span class="string">`last_name`</span>,a.<span class="string">`manager_id`</span>,b.<span class="string">`last_name`</span> manager_name</span><br><span class="line"><span class="keyword">FROM</span> employees a</span><br><span class="line"><span class="keyword">JOIN</span> employees b</span><br><span class="line"><span class="keyword">ON</span> a.<span class="string">`manager_id`</span>=b.<span class="string">`employee_id`</span>;	</span><br></pre></td></tr></table></figure>



<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4><p><strong>左/右外连接查询的特点</strong>：（<strong>注意主表、从表的概念</strong>）</p>
<ul>
<li>查询结果<strong>保留主表的所有记录</strong>，对于从表，若有与主表匹配额的，显示匹配的值；<strong>若没用匹配的，显示null</strong>。</li>
<li><strong>区分主表从表</strong>：<strong>对于左外连接，左主右从；对于右连接，右主左从</strong>。</li>
<li><strong>可用于查询两表除了交集部分的剩余不匹配的记录</strong>。</li>
</ul>
<p>​        </p>
<p>eg，例子只用了左外连接，右外连接同理，此处省略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#1.查询所有女神，且若女神有男朋友，显示男朋友名</span><br><span class="line">SELECT b.&#96;id&#96;,b.name,bo.boyName</span><br><span class="line">FROM beauty b</span><br><span class="line">LEFT JOIN boys bo</span><br><span class="line">ON b.&#96;boyfriend_id&#96;&#x3D;bo.&#96;id&#96;;</span><br><span class="line"></span><br><span class="line">#2.查询莫得男朋友的女神</span><br><span class="line">#先查询出上面例子的中间表，再使用筛选条件筛出莫得男朋友的女神</span><br><span class="line">SELECT b.name </span><br><span class="line">FROM beauty b </span><br><span class="line">LEFT JOIN boys bo </span><br><span class="line">ON b.&#96;boyfriend_id&#96; &#x3D; bo.&#96;id&#96; </span><br><span class="line">WHERE bo.&#96;id&#96; IS NULL;</span><br></pre></td></tr></table></figure>

<p><strong>上述例题2的实现可见如下图解</strong>：</p>
<img src="https://gitee.com/bxgitee/noteImage/raw/master/image/image-20200714170433903.png" alt="image-20200714170433903" style="zoom:67%;" />



<p>​        对于全外连接，MySQL不支持，<strong>理论上全外连接的查询结果是：对两个表的左外连接与右外连接的查询结果的并集</strong>。</p>
<h4 id="交叉连接"><a href="#交叉连接" class="headerlink" title="交叉连接"></a>交叉连接</h4><p>​        交叉连接其实就是笛卡尔乘积的sql99标准写法。。。</p>
<p>即以下两钟查询结果相同：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT b.name,bo.boyName</span><br><span class="line">FROM beauty b</span><br><span class="line">CROSS JOIN boys bo;</span><br><span class="line"></span><br><span class="line">SELECT b.name,bo.boyName</span><br><span class="line">FROM beauty b,boys bo;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p>​        <strong>出现在其他语句内部的select语句，成为子查询语句；相应的，内部嵌套其他select语句的查询成为外查询语句</strong>。子查询必须放在<code>()</code>内。</p>
<p>​        <strong>子查询按结果集的行列数不同可分为</strong>：</p>
<ul>
<li><strong>标量子查询</strong>（结果集只有一行一列，<strong>即一个单一值</strong>）</li>
<li><strong>列子查询</strong>（一列多行）</li>
<li><strong>行子查询</strong>（一行多列）</li>
<li><strong>表子查询</strong>（多行多列）</li>
</ul>
<p>​        <strong>子查询可出现的位置</strong>：</p>
<ul>
<li>select后：<strong>仅支持标量子查询</strong>。</li>
<li>from后：支持上述所有查询。</li>
<li>where或having后：支持标量子查询、列、行子查询。</li>
<li>exists后（相关子查询）：表子查询。</li>
</ul>
<p>以下按子查询出现位置展开。</p>
<h4 id="where-having后的子查询"><a href="#where-having后的子查询" class="headerlink" title="where/having后的子查询"></a><span style="font-size:20px;">where/having后的子查询</span></h4><p>​        where/having后的子查询支持标量、列、行子查询。其中</p>
<ul>
<li><p>若条件表达式是<code>&gt;  &lt;  =  &lt;=  &gt;= &lt;&gt;</code>，<strong>则必须使用标量子查询，因为这些运算符只能匹配一个操作数</strong>。</p>
</li>
<li><p>若<strong>使用列子查询，一般搭配<code>in</code>，<code>any/some</code>，<code>all</code>关键字</strong>。</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>in/not in</td>
<td>等于（或不等于）列表中的任一个</td>
</tr>
<tr>
<td>any/some（两者意义相同）</td>
<td>与列表中的任意一个比较满足条件，可用min、max代替</td>
</tr>
<tr>
<td>all</td>
<td>与列表中的所有值比较都满足条件</td>
</tr>
</tbody></table>
</li>
<li><p><strong>子查询的执行优先度高于主查询</strong>，因为主查询需用到子查询作为判断条件。</p>
</li>
</ul>
<p>标量子查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#1.工资比Abel高的员工</span><br><span class="line">SELECT last_name FROM employees</span><br><span class="line">WHERE salary&gt;(</span><br><span class="line">	#标量子查询</span><br><span class="line">	SELECT salary </span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE last_name&#x3D;&#39;Abel&#39;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#2.返回job_id与141号员工相同,sa1a比143号员工多的员工姓名, job_id和工资</span><br><span class="line">SELECT last_name,job_id,salary </span><br><span class="line">FROM employees</span><br><span class="line">WHERE job_id&#x3D;(</span><br><span class="line">	SELECT job_id FROM employees</span><br><span class="line">	WHERE employee_id&#x3D;141</span><br><span class="line">)</span><br><span class="line">AND</span><br><span class="line">salary&gt;(</span><br><span class="line">	SELECT salary FROM employees</span><br><span class="line">	WHERE employee_id&#x3D;143</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#3.查询最低工资大于50号部门最低工资 的 部门id 和 其最低工资</span><br><span class="line"></span><br><span class="line">SELECT department_id,MIN(salary)</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id</span><br><span class="line">HAVING MIN(salary)&gt;(</span><br><span class="line">	SELECT MIN(salary) FROM employees</span><br><span class="line">	WHERE department_id&#x3D;50</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<p>列子查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#1.返回1ocation_id是1400或1700的部门中的所有员工姓名</span><br><span class="line">SELECT last_name FROM employees</span><br><span class="line">WHERE department_id IN(</span><br><span class="line">	SELECT department_id FROM locations</span><br><span class="line">	WHERE location_id IN (1400,1700)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#2.返回其它工种中比（job_id为IT_PROG工种任一工资 1）低的员工的（员工号、姓名、job_id以及sa1ary 2）</span><br><span class="line">SELECT employee_id,last_name,job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&lt;ANY(</span><br><span class="line">	SELECT DISTINCT salary FROM employees</span><br><span class="line">	WHERE job_id&#x3D;&#39;IT_PROG&#39;</span><br><span class="line">) AND  job_id&lt;&gt;&#39;IT_PROG&#39;;</span><br></pre></td></tr></table></figure>

<p><strong>行子查询（一行多列或多行多列）</strong>：<strong>当筛选条件个数&gt;=2，且使用的判断符都一样，可以使用行子查询对多个字段同时判断</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#查询员工编号最小，工资最高的员工信息</span><br><span class="line">SELECT * FROM employees</span><br><span class="line">WHERE (employee_id,salary)&#x3D;(</span><br><span class="line">	SELECT MIN(employee_id),MAX(salary)</span><br><span class="line">	FROM employees</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h4 id="select后的子查询"><a href="#select后的子查询" class="headerlink" title="select后的子查询"></a><span style="font-size:20px;">select后的子查询</span></h4><p>select后的子查询只支持标量子查询。<strong><font color="red">若子查询结果为空，则返回null值</font></strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#每个部门的员工个数</span><br><span class="line">SELECT d.department_name,(</span><br><span class="line">	SELECT COUNT(*) </span><br><span class="line">	FROM employees e</span><br><span class="line">	WHERE d.&#96;department_id&#96; &#x3D;e.department_id</span><br><span class="line">) &#39;count&#39; FROM departments d;</span><br></pre></td></tr></table></figure>



<h4 id="from后的子查询"><a href="#from后的子查询" class="headerlink" title="from后的子查询"></a><span style="font-size:20px;">from后的子查询</span></h4><p>from后的子查询可支持任何类型的子查询。eg：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#查询每个部门的平均工资的工资等级</span><br><span class="line">#先查询每个部门的平均工资，再与工资等级表进行内连接查询</span><br><span class="line">SELECT ag_dep.*,grade_level</span><br><span class="line">FROM (</span><br><span class="line">	SELECT department_id,AVG(salary) ag</span><br><span class="line">	FROM employees</span><br><span class="line">	GROUP BY department_id</span><br><span class="line">) ag_dep</span><br><span class="line">INNER JOIN job_grades j</span><br><span class="line">ON ag_dep.ag BETWEEN j.&#96;lowest_sal&#96; AND j.&#96;highest_sal&#96;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="exists后的子查询"><a href="#exists后的子查询" class="headerlink" title="exists后的子查询"></a><span style="font-size:20px;">exists后的子查询</span></h4><p>**exists函数语法：<code>exists(查询语句)</code>**。</p>
<p><strong>当查询语句的结果集不为空，则返回1，否则返回0</strong>。</p>
<p>eg：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#有员工的部门名</span><br><span class="line">SELECT department_name </span><br><span class="line">FROM departments d</span><br><span class="line">WHERE EXISTS(</span><br><span class="line">	SELECT * </span><br><span class="line">	FROM employees e</span><br><span class="line">	WHERE e.&#96;department_id&#96;&#x3D;d.&#96;department_id&#96;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"># 用列子查询</span><br><span class="line">SELECT department_name</span><br><span class="line">FROM departments d</span><br><span class="line">WHERE d.&#96;department_id&#96; </span><br><span class="line">IN(</span><br><span class="line">SELECT e.department_id</span><br><span class="line">FROM employees e</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="分页查询（Limit）"><a href="#分页查询（Limit）" class="headerlink" title="分页查询（Limit）"></a>分页查询（Limit）</h3><p>​        当要显示的查询结果过多，只需先显示部分记录时，可用<code>limit</code>进行分页查询。**<code>limit</code>语句要放在查询语句的最后**。</p>
<p>​        语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">limit size #显示从第一条记录开始的size条记录</span><br><span class="line"></span><br><span class="line">-- 显示从第pos（索引从0开始）条开始的size条记录</span><br><span class="line">limit pos,size </span><br><span class="line">-- 或</span><br><span class="line">limit pos offset size</span><br></pre></td></tr></table></figure>



<p><strong>对于web应用中的分页查询，假如要显示第page页，每页有size个记录，则查询语句为：</strong> </p>
<p><strong><code>select * from tableName limit (page-1)*size,size;</code></strong> </p>
<h3 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h3><p>&emsp;&emsp;<strong>联合查询的作用是将多条查询语句的结果集合并为一个结果集</strong>。当要查询的<strong>信息来自多个表</strong>，且要查询的信息对应的<strong>字段在这些表中的类型一致</strong>，但这些表又<strong>没有直接关联</strong>，这时可使用联合查询。<strong>联合查询使用``UNION`关键字</strong>。</p>
<p>联合查询的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查询语句1</span><br><span class="line">union</span><br><span class="line">查询语句2</span><br><span class="line">union</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>联合查询的特点：</p>
<ul>
<li><strong>多条查询语句的查询列数必须一致</strong>。</li>
<li>每一列的类型必须一致；为了查询结果的正确显示，字段顺序也要一致（<strong>不一致不会报错，但结果会错误显示</strong>）。</li>
<li><strong>union关键字默认去重，可使用<code>union all</code>显示重复项</strong>。</li>
<li><strong>查询结果集的字段名与第一条查询语句的查询字段对应</strong>。</li>
</ul>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,cname,csex <span class="keyword">from</span> t_ca <span class="keyword">where</span> csex=<span class="string">&#x27;男&#x27;</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> t_id,tName,tGender <span class="keyword">from</span> t_ua <span class="keyword">where</span> tGender=<span class="string">&#x27;male&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h2 id="MySQL基础-DML"><a href="#MySQL基础-DML" class="headerlink" title="MySQL基础-DML"></a>MySQL基础-DML</h2><p>&emsp;&emsp;DML（Data Manage Language），数据操作语言，用于<strong>对表进行插入（insert）、删除（delete）、更新（update）操作</strong>。</p>
<h3 id="插入（insert）"><a href="#插入（insert）" class="headerlink" title="插入（insert）"></a>插入（insert）</h3><p>&emsp;&emsp;插入语句的语法有两种，如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name[(colum1, colum2, ...)]  <span class="comment">#该部分省略时默认所有字段</span></span><br><span class="line"><span class="keyword">VALUES</span>(value1, value2, ...)</span><br><span class="line">[, (value11, value22, ...)] ; <span class="comment">#可同时插入多个记录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name</span><br><span class="line"><span class="keyword">SET</span> colum1=value1, colum2=value2, ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">#3</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name[(colum1, colum2, ...)]</span><br><span class="line"><span class="keyword">SELECT</span> ...;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;第一种方式可以同时插入多个记录，<strong>字段列表可省略，省略时默认插入表对应的所有字段</strong>；当只是要插入一条记录，且插入少数字段，可使用第二种方式，更为简便，<strong>但不支持插入多条记录</strong>。<strong><span style="color:red;">还可以通过子查询语句插入记录，此时子查询语句的查询列表要与要插入的表的字段对应</span></strong>。</p>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty </span><br><span class="line"><span class="keyword">VALUES</span>(<span class="literal">NULL</span>, <span class="string">&#x27;女朋友&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;2000-02-26&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="literal">NULL</span>, <span class="number">2</span>); <span class="comment">#主键部分写null即可</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#插入多条记录</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty(<span class="keyword">NAME</span>, sex, borndate, phone) </span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;女朋友&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;2000-02-26&#x27;</span>, <span class="string">&#x27;4546984&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;迪丽热巴&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;2020-02-26&#x27;</span>, <span class="string">&#x27;549884&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用第二种语法</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty </span><br><span class="line"><span class="keyword">set</span> <span class="keyword">name</span>=<span class="string">&#x27;ggggg&#x27;</span>, borndate=<span class="string">&#x27;1998-02-25&#x27;</span>, phone=<span class="string">&#x27;8582321&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>通过子查询插入值。eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> beauty(<span class="keyword">id</span>,<span class="keyword">name</span>,phone)</span><br><span class="line"><span class="keyword">select</span> <span class="number">26</span>,<span class="string">&#x27;宋茜&#x27;</span>,<span class="string">&#x27;856132123&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="更新（update）"><a href="#更新（update）" class="headerlink" title="更新（update）"></a>更新（update）</h3><p>​        更新表的SQL语句语法：<strong>其中，更新多表记录就是先将多个表连接起来，再对连接后的结果集进行更改。更改操作将作用到原表</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#更新单表记录</span></span><br><span class="line"><span class="keyword">UPDATE</span> table_name</span><br><span class="line"><span class="keyword">SET</span> colum1=new_value1, colum2=new_value2, ...</span><br><span class="line"><span class="keyword">WHERE</span> condition; <span class="comment">#若不加筛选条件，会对字段对应的所有记录修改</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#更新多表记录(sql99标准)</span></span><br><span class="line"><span class="keyword">UPDATE</span> table_name1 [<span class="keyword">alias</span>]</span><br><span class="line">JOIN_TYPE <span class="keyword">JOIN</span> table_name2 [<span class="keyword">alias</span>]</span><br><span class="line"><span class="keyword">ON</span> join_condition</span><br><span class="line"><span class="keyword">SET</span> colum1=new_value1, colum2=new_value2, ...</span><br><span class="line"><span class="keyword">WHERE</span> condition;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>eg:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> boys </span><br><span class="line"><span class="keyword">SET</span> boyname=<span class="string">&#x27;张飞&#x27;</span> </span><br><span class="line"><span class="keyword">WHERE</span> boyname=<span class="string">&#x27;鹿晗&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#多表更新</span></span><br><span class="line"><span class="comment">#修改张无忌的女朋友的电话号码为114455。需要先将boys表跟beauty表进行内连接</span></span><br><span class="line"><span class="keyword">UPDATE</span> boys bo</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> beauty be</span><br><span class="line"><span class="keyword">ON</span> bo.<span class="string">`id`</span>=be.<span class="string">`boyfriend_id`</span></span><br><span class="line"><span class="keyword">SET</span> be.<span class="string">`phone`</span>=<span class="string">&#x27;114455&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> bo.<span class="string">`boyName`</span>=<span class="string">&#x27;张无忌&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="删除（delete）"><a href="#删除（delete）" class="headerlink" title="删除（delete）"></a>删除（delete）</h3><p>​        删除语句会删除满足条件的所有记录。且删除语句也支持单表跟多表的删除，其语法如下：其中：</p>
<ul>
<li>多表删除中，<strong>若只是想删除其中一个表的记录，DELETE后的只写要删除的表的表名即可</strong>。总之，delete后写上要删除的记录对应的表。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#单表</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> condition;  <span class="comment">#若不加筛选条件，该语句会删除整个表的记录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#多表</span></span><br><span class="line"><span class="keyword">DELETE</span> alias1,alias2</span><br><span class="line"><span class="keyword">FROM</span> table1_name alias1</span><br><span class="line">[join_type] <span class="keyword">join</span> table2_name alias2</span><br><span class="line"><span class="keyword">ON</span> join_condition</span><br><span class="line"><span class="keyword">WHERE</span> condition;</span><br></pre></td></tr></table></figure>



<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> beauty <span class="keyword">where</span> phone <span class="keyword">like</span> <span class="string">&#x27;%9&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#多表删除（该例子只删除beauty表）</span></span><br><span class="line"><span class="comment">#删除张无忌的女朋友的信息</span></span><br><span class="line"><span class="keyword">DELETE</span> be</span><br><span class="line"><span class="keyword">FROM</span> boys bo</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> beauty be</span><br><span class="line"><span class="keyword">ON</span> bo.<span class="string">`id`</span>=be.<span class="string">`boyfriend_id`</span></span><br><span class="line"><span class="keyword">WHERE</span> bo.<span class="string">`boyName`</span>=<span class="string">&#x27;张无忌&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>当要删除整个表的记录，可以使用<code>truncate</code>关键字，语法是<code>TRUNCATE [TABLE] table_name;</code>。</p>
<p>使用delete删除跟truncate删除的<strong>区别</strong>：</p>
<ul>
<li>truncate不能加<code>where</code>。</li>
<li>truncate的删除效率稍微高一点。</li>
<li>若表中有自增长列，<strong>使用delete删除后不会改变当前的自增长值</strong>；<strong>而使用truncate删除后自增长值变为1</strong>。</li>
<li><strong>truncate不能返回受影响的记录数，而delete可以</strong>。</li>
<li><strong><span style="color:red">在事务方面</span>**：</strong>delete是可以回滚的，而truncate不可回滚**。</li>
</ul>
<h2 id="MySQL基础-DDL"><a href="#MySQL基础-DDL" class="headerlink" title="MySQL基础-DDL"></a>MySQL基础-DDL</h2><p>​        数据定义语言（Data Define Language， DDL）用于对数据库、表进行创建、修改、删除操作。</p>
<h3 id="库的管理"><a href="#库的管理" class="headerlink" title="库的管理"></a>库的管理</h3><p>库的相关语法如下：<strong>其中，对于创建、删除库，若是库已存在或不存在会报错，可使用<code>IF (NOT) EXISTS</code>进行判断，使语句正确执行</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建库</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] database_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除库</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> [<span class="keyword">IF</span> <span class="keyword">EXISTS</span>] database_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改库</span></span><br><span class="line"><span class="comment">#修改库名（该语法似乎不用了）</span></span><br><span class="line"><span class="keyword">RENAME</span> <span class="keyword">DATABASE</span> database_name <span class="keyword">TO</span> new_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改字符集</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">DATABASE</span> database_name <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> character_name;</span><br></pre></td></tr></table></figure>



<h3 id="表的管理"><a href="#表的管理" class="headerlink" title="表的管理"></a>表的管理</h3><h4 id="1-表的创建"><a href="#1-表的创建" class="headerlink" title="1.表的创建"></a>1.表的创建</h4><p>创建表的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] table_name(</span><br><span class="line">	colum_name COLUM_TYPE [(<span class="keyword">length</span>) 约束],</span><br><span class="line">	colum_name COLUM_TYPE [(<span class="keyword">length</span>) 约束],</span><br><span class="line">    ...</span><br><span class="line">    colum_name COLUM_TYPE [(<span class="keyword">length</span>) 约束],</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<p>eg:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> book(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span>,</span><br><span class="line">	bname <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	author <span class="built_in">VARCHAR</span>(<span class="number">10</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h4 id="2-表的修改"><a href="#2-表的修改" class="headerlink" title="2.表的修改"></a>2.表的修改</h4><p>表的修改有修改列名、修改列的类型或约束、添加新列、删除列以及修改修改表名。对应的语法为：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改表</span></span><br><span class="line">    <span class="comment">-- 修改表本身的选项</span></span><br><span class="line">        <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 表的选项（具体选项可见 <span class="number">5.</span>-）</span><br><span class="line">        eg: <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ENGINE</span>=MYISAM;</span><br><span class="line">    <span class="comment">-- 对表进行重命名</span></span><br><span class="line">        <span class="keyword">RENAME</span> <span class="keyword">TABLE</span> 原表名 <span class="keyword">TO</span> 新表名</span><br><span class="line">        <span class="keyword">RENAME</span> <span class="keyword">TABLE</span> 原表名 <span class="keyword">TO</span> 库名.表名 （可将表移动到另一个数据库）</span><br><span class="line">        <span class="comment">-- RENAME可以交换两个表名</span></span><br><span class="line">    <span class="comment">-- 修改表的字段机构</span></span><br><span class="line">        <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 操作名</span><br><span class="line">        <span class="comment">-- 操作名</span></span><br><span class="line">            <span class="keyword">ADD</span>[ <span class="keyword">COLUMN</span>] 字段定义       <span class="comment">-- 增加字段</span></span><br><span class="line">                <span class="keyword">AFTER</span> 字段名          <span class="comment">-- 表示增加在该字段名后面</span></span><br><span class="line">                <span class="keyword">FIRST</span>               <span class="comment">-- 表示增加在第一个</span></span><br><span class="line">            <span class="keyword">ADD</span> PRIMARY <span class="keyword">KEY</span>(字段名)   <span class="comment">-- 创建主键</span></span><br><span class="line">            <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> [索引名] (字段名)<span class="comment">-- 创建唯一索引</span></span><br><span class="line">            <span class="keyword">ADD</span> <span class="keyword">INDEX</span> [索引名] (字段名) <span class="comment">-- 创建普通索引</span></span><br><span class="line">            <span class="keyword">DROP</span>[ <span class="keyword">COLUMN</span>] 字段名      <span class="comment">-- 删除字段</span></span><br><span class="line">            <span class="keyword">MODIFY</span>[ <span class="keyword">COLUMN</span>] 字段名 字段属性     <span class="comment">-- 支持对字段属性进行修改，不能修改字段名(所有原有属性也需写上)</span></span><br><span class="line">            <span class="keyword">CHANGE</span>[ <span class="keyword">COLUMN</span>] 原字段名 新字段名 字段属性      <span class="comment">-- 支持对字段名修改</span></span><br><span class="line">            <span class="keyword">DROP</span> PRIMARY <span class="keyword">KEY</span>    <span class="comment">-- 删除主键(删除主键前需删除其AUTO_INCREMENT属性)</span></span><br><span class="line">            <span class="keyword">DROP</span> <span class="keyword">INDEX</span> 索引名 <span class="comment">-- 删除索引</span></span><br><span class="line">            <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> 外键    <span class="comment">-- 删除外键</span></span><br><span class="line">        <span class="comment">-- 删除约束</span></span><br><span class="line">        	<span class="comment"># 除了上面3个drop，删除一些列级约束可以通过modify</span></span><br><span class="line">        	<span class="keyword">MODIFY</span> [<span class="keyword">COLUMN</span>] 字段名 字段类型 [新的约束];  <span class="comment">-- 通过这种方法重新让字段没有约束越换成新的约束</span></span><br></pre></td></tr></table></figure>

<p>TIPS：**表的修改中不支持<code>if (not) exists</code>**。</p>
<h4 id="3-表的删除"><a href="#3-表的删除" class="headerlink" title="3.表的删除"></a>3.表的删除</h4><p><code>DROP TABLE [IF EXISTS] table_name</code>.</p>
<p>在sql脚本文件中写表或库创建的语句时，可以先删除表或库再创建，如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> database_name;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> database_name;</span><br></pre></td></tr></table></figure>



<h4 id="4-表的复制"><a href="#4-表的复制" class="headerlink" title="4.表的复制"></a>4.表的复制</h4><p>表的复制可分为：</p>
<ul>
<li><p><strong>通过<code>LIKE</code>关键字</strong>仅复制表的结构（<strong>复制全部字段，不包含数据</strong>）：<strong><code>CREATE TABLE copy_table_name LIKE exists_table;</code></strong> </p>
</li>
<li><p>复制表的结构（<strong>部分或全部字段</strong>）跟数据（<strong>部分或全部数据</strong>）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> copy_table_name </span><br><span class="line"><span class="keyword">SELECT</span> 查询列表 <span class="keyword">FROM</span> exists_table</span><br><span class="line"><span class="keyword">WHERE</span> condition;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>通过查询列表来选择要复制的字段（使用<code>select *</code>即实现复制全部字段）</strong>。</li>
<li>通过<code>where</code>来筛选要复制的数据。<strong>可以通过<code>where 0</code>来过滤掉全部的数据，即只复制部分或全部字段</strong>；也可以直接去掉where来复制所选字段对应的全部数据。</li>
</ul>
</li>
</ul>
<h4 id="5-表的选项-查看表结构"><a href="#5-表的选项-查看表结构" class="headerlink" title="5.表的选项/查看表结构"></a>5.表的选项/查看表结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">表选项</span><br><span class="line">    -- 字符集</span><br><span class="line">        CHARSET &#x3D; charset_name</span><br><span class="line">        如果表没有设定，则使用数据库字符集</span><br><span class="line">    -- 存储引擎</span><br><span class="line">        ENGINE &#x3D; engine_name</span><br><span class="line">        表在管理数据时采用的不同的数据结构，结构不同会导致处理方式、提供的特性操作等不同</span><br><span class="line">        常见的引擎：InnoDB MyISAM Memory&#x2F;Heap BDB Merge Example CSV MaxDB Archive</span><br><span class="line">        不同的引擎在保存表的结构和数据时采用不同的方式</span><br><span class="line">        MyISAM表文件含义：.frm表定义，.MYD表数据，.MYI表索引</span><br><span class="line">        InnoDB表文件含义：.frm表定义，表空间数据和日志文件</span><br><span class="line">        </span><br><span class="line">        SHOW ENGINES -- 显示存储引擎的状态信息</span><br><span class="line">        SHOW ENGINE 引擎名 &#123;LOGS|STATUS&#125; -- 显示存储引擎的日志或状态信息</span><br><span class="line">    -- 自增起始数</span><br><span class="line">        AUTO_INCREMENT &#x3D; 行数</span><br><span class="line">    -- 数据文件目录</span><br><span class="line">        DATA DIRECTORY &#x3D; &#39;目录&#39;</span><br><span class="line">    -- 索引文件目录</span><br><span class="line">        INDEX DIRECTORY &#x3D; &#39;目录&#39;</span><br><span class="line">    -- 表注释</span><br><span class="line">        COMMENT &#x3D; &#39;string&#39;</span><br><span class="line">    -- 分区选项</span><br><span class="line">        PARTITION BY ... (详细见手册)</span><br><span class="line">-- 查看表结构</span><br><span class="line">    SHOW CREATE TABLE 表名 （信息更详细）</span><br><span class="line">    DESC 表名 &#x2F; DESCRIBE 表名 &#x2F; EXPLAIN 表名 &#x2F; SHOW COLUMNS FROM 表名 [LIKE &#39;PATTERN&#39;]</span><br><span class="line">    SHOW TABLE STATUS [FROM db_name] [LIKE &#39;pattern&#39;]  </span><br></pre></td></tr></table></figure>



<hr>
<h2 id="MySQL基础-数据类型"><a href="#MySQL基础-数据类型" class="headerlink" title="MySQL基础-数据类型"></a>MySQL基础-数据类型</h2><p>MySQL的数据类型有：</p>
<ul>
<li>数值型：<ul>
<li>整型</li>
<li>小数：定点、浮点</li>
</ul>
</li>
<li>字符型：<ul>
<li>短文本：char、varchar</li>
<li>长文本：text、blob(较长的二进制数据)</li>
</ul>
</li>
<li>日期型</li>
</ul>
<h3 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h3><p>​        整形数据按字节大小可分为（括号内为字节数）：**tinyint(1)、smallint(2)、mediumint(3)、int/integer(4)、bigint(8)**。</p>
<p><strong>整形数据的特点</strong>：</p>
<ul>
<li><p>整形数据有有符号数和无符号数，默认是有符号数；要设置有符号数需在建表时添加**<code>UNSIGNED</code>关键字**。如：</p>
<p><code>create table test(t1 int, t2 int unsigned);</code>。</p>
</li>
<li><p>若插入的数值<strong>超出了类型值的范围</strong>，会报<code>out of range</code>异常，且<strong>会插入离插入的数值近的临界值</strong>。如<strong>把一个负数赋值给无符号数，不是把负数转化为无符号数，而是用0赋值</strong>。</p>
</li>
<li><p><strong><span style="color:red">整型值的长度指的是最多能显示出来有多少个数字</span></strong>。若无指定，每种类型的整型都有默认长度。建表时可以使用<code>ZEROFILL</code>关键字，当不足长度时用0进行左填充。eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> testss(</span><br><span class="line">	t1 <span class="built_in">INT</span>(<span class="number">7</span>) ZEROFILL</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> testss <span class="keyword">VALUES</span>(<span class="number">55</span>);<span class="comment">#插入55，因为使用了zerofill关键字，会对55左填充0，即0000055.</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="小数"><a href="#小数" class="headerlink" title="小数"></a>小数</h3><p>小数类型有浮点型和定点型：</p>
<ul>
<li>浮点型<ul>
<li>float(M, D)</li>
<li>double(M, D)</li>
</ul>
</li>
<li>定点型：dec/decimal(M, D)</li>
</ul>
<p>​        其中（M, D)的形式在建表时使用，<strong>M指整个数值的长度（意义同整型的长度），即整数部分长度+小数部分长度；D指小数部分的长度</strong>。也可省略，省略时dec默认是（10，0），而float跟double会自适应插入的数。</p>
<p>​        对于精度而言，定点型的精度较高，对高精度要求的数据使用定点型。一般选择的类型越简单越好。</p>
<h3 id="字符型"><a href="#字符型" class="headerlink" title="字符型"></a>字符型</h3><p>字符型的分类：</p>
<ul>
<li><p><strong>短文本</strong></p>
<ul>
<li>char：<strong>建表时最大字符数可以省略，默认为1。该类型是固定长度的字符，即<span style="color:red">不管存入的数据是多少个字符，占用的空间都是指定的最大字符数</span></strong>。</li>
<li>varchar：<strong>建表时最大字符数<span style="color:red">不可以省略</span>。该类型是可变长度的字符，即<span style="color:red">占用的空间根据存入的数据自适应，多大就存多少空间</span>（存入数据&lt;=指定的最大字符数时）</strong>。</li>
<li><strong>char类型的空间耗费更大、但效率更高；varchar反之</strong>。当要存入的数据是固定长度的，如性别，只有男女，就可以使用char类型。</li>
</ul>
</li>
<li><p><strong>长文本</strong></p>
<ul>
<li>text</li>
<li>blob（存放较大的二进制）</li>
</ul>
</li>
<li><p>其他</p>
<ul>
<li><p>binary、varbinary：类似char跟varchar。用于保存较短的二进制。</p>
</li>
<li><p>enum，用于保存枚举（只能保存一个数据），保存的值必须是枚举列表之一，枚举列表在建表时指定，eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> enumm(</span><br><span class="line">	colum1 ENUM(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> enumm <span class="keyword">VALUES</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> enumm <span class="keyword">VALUES</span>(<span class="string">&#x27;A&#x27;</span>);<span class="comment">#mysql不区分大小写，插入a、A效果一样</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> enumm <span class="keyword">VALUES</span>(<span class="string">&#x27;d&#x27;</span>);<span class="comment">#插入的值不是枚举列表之一，报错</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>set，用于保存集合（可以保存多个数据），和enum类似，但可以保存多个值。eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sett(</span><br><span class="line">	s1 <span class="keyword">SET</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> sett <span class="keyword">VALUES</span>(<span class="string">&#x27;a,b&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> sett <span class="keyword">VALUES</span>(<span class="string">&#x27;a,b,e&#x27;</span>);<span class="comment">#报错</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>enum、set值占用的存储空间随列表值个数的增加而增加。</p>
</li>
</ul>
</li>
</ul>
<h3 id="日期类型"><a href="#日期类型" class="headerlink" title="日期类型"></a>日期类型</h3><p><strong>日期类型如下表</strong>：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>字节</th>
<th>最小值</th>
<th>最大值</th>
</tr>
</thead>
<tbody><tr>
<td>DATE</td>
<td>4</td>
<td>1000-01-01（<strong>只有日期</strong>）</td>
<td>9999-12-31</td>
</tr>
<tr>
<td>DATETIME</td>
<td>8</td>
<td>1000-01-01 00:00:00（<strong>日期+时间</strong>）</td>
<td>9999-12-31 23:59:59</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>4</td>
<td>19700101080001（<strong>日期+时间</strong>）</td>
<td>2038 年的某个时刻</td>
</tr>
<tr>
<td>TIME</td>
<td>3</td>
<td>-838:59:59（<strong>只有时间</strong>）</td>
<td>838:59:59</td>
</tr>
<tr>
<td>YEAR</td>
<td>1</td>
<td>1901（<strong>只有年</strong>）</td>
<td>2155</td>
</tr>
</tbody></table>
<h4 id="timestamp和datetime"><a href="#timestamp和datetime" class="headerlink" title="timestamp和datetime"></a><span style="color:red">timestamp和datetime</span></h4><ul>
<li><p><strong>时间范围不一样</strong>，<strong>TIMESTAMP 要小很多</strong> ，2038年到期。</p>
</li>
<li><p><strong>对于TIMESTAMP，它<span style="color:red">把客户端插入的时间从当前时区转化为UTC（世界标准时间）进行存储。查询时，将其又转化为客户端当前时区（即根据系统变量<code>time_zone</code>的值）对应的时间进行返回</span>。而对于DATETIME，不做任何改变，原样输入和输出</strong>。</p>
</li>
<li><p>timestamp<strong>更能反应实际的日期</strong>。</p>
</li>
</ul>
<p>eg：（tips：<strong>中国位于东八时区</strong>，当前时间是2020-7-15 21:40分左右）</p>
<p>创建表并插入数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> timee(</span><br><span class="line">	t1 DATETIME,</span><br><span class="line">	t2 <span class="built_in">TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> timee <span class="keyword">VALUES</span>(<span class="keyword">NOW</span>(),<span class="keyword">NOW</span>());</span><br></pre></td></tr></table></figure>

<p><strong><span style="color:red">此时保存的t1值是21:49:36，而保存的t2值是21:49:36对应的UTC时间</span></strong>。</p>
<p>使用<code>select * from timee;</code>查询表，如下：</p>
<p><img src="https://gitee.com/bxgitee/noteImage/raw/master/image/image-20200715214946323.png" alt="image-20200715214946323"></p>
<p>设置当前时区为东九区：<code>SET time_zone=&#39;+9:00&#39;;</code> </p>
<p>再次执行：<code>INSERT INTO timee VALUES(NOW(),NOW());</code> <strong><span style="color:red">此时保存的t1值是22:49:53，而保存的t2值是22:49:53对应的UTC时间</span></strong>。</p>
<p><strong>此时是东九区，所以时间是22：40几分</strong>，查询出此时的表是： </p>
<p><img src="https://gitee.com/bxgitee/noteImage/raw/master/image/image-20200715215006182.png" alt="image-20200715215006182"></p>
<p>可见，两次查询t1的两个值都不变，插入时的时间是什么，查询出的是什么。</p>
<p><strong>而t2查询出的值是保存的UTC时间转化为当前时区的时间</strong>。<strong>比如第一行的t2值，插入数据时是东八区的晚上九点多，该时刻的东九区就是晚上10点多</strong>，所以在东九区查询得出的值与在东八区查询得出的值不一样。</p>
<hr>
<h2 id="MySQL基础-约束"><a href="#MySQL基础-约束" class="headerlink" title="MySQL基础-约束"></a>MySQL基础-约束</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><p>​        约束就是一种限制，用于限制表中的数据，<strong>使数据有更好的准确和可靠性</strong>。</p>
<p>MySQL中的常见约束：</p>
<table>
<thead>
<tr>
<th>约束类型</th>
<th>主键</th>
<th>外键</th>
<th>唯一</th>
<th>非空</th>
<th>自增</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>关键字</td>
<td>primary key</td>
<td>foreign key</td>
<td>unique</td>
<td>not null</td>
<td>auto_increment</td>
<td>default</td>
</tr>
<tr>
<td>含义</td>
<td>相当于unique+<br>not null，一般用于id</td>
<td>用于限制两个表的关系，<br/>即从表的某个字段指向主表的某一字段</td>
<td>唯一性、<br/><strong>可以为空</strong></td>
<td>不能为空</td>
<td>自增</td>
<td>指定字段的默认值</td>
</tr>
</tbody></table>
<p>​        添加约束可以在<strong>创建表时或修改表时</strong>。</p>
<p>​        <strong>约束又可分为列级约束和表级约束：除了外键，其他约束都支持列级约束；除了非空、默认以及自增，其他约束都支持表级约束</strong>。列级约束在创建表时<strong>在字段名+字段数据类型之后添加即可</strong>；表级约束在最底下声明，语法为：</p>
<p><code>[CONSTRAINT constraint_name] CONSTRAINT_TYPE(colum_name)</code> </p>
<p><strong>主键、唯一键可以使用列级跟表级两种语法进行声明</strong>。</p>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#列级约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> major(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">	major_name <span class="built_in">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">UNIQUE</span> <span class="comment">#可以同时添加多个约束</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stuinfo(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT,</span><br><span class="line">	stu_name <span class="built_in">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">	stu_number <span class="built_in">CHAR</span>(<span class="number">8</span>),</span><br><span class="line">	majorid <span class="built_in">INT</span> ,</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> fk_stuinfo_major <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(majorid) <span class="keyword">REFERENCES</span> major(<span class="keyword">id</span>),</span><br><span class="line">	<span class="keyword">UNIQUE</span>(stu_number),</span><br><span class="line">	PRIMARY <span class="keyword">KEY</span>(<span class="keyword">id</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h3 id="PRIMARY-KEY和UNIQUE"><a href="#PRIMARY-KEY和UNIQUE" class="headerlink" title="PRIMARY KEY和UNIQUE"></a><code>PRIMARY KEY</code>和<code>UNIQUE</code></h3><ul>
<li>两者都保证了唯一性，但主键不能为空。</li>
<li>一个表中只能有一个主键，但可以有多个unique。</li>
<li><strong><span style="color:red">unique约束的字段，是可以插入多个null值的</span></strong>。</li>
<li><strong>可以多个字段组合成一个主键或unique</strong>。**<span style="color:red;">该方式不推荐</span>**。</li>
</ul>
<p>关于上述组合的解释：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">test</span>(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> ,</span><br><span class="line">	sname <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	<span class="built_in">number</span> <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	PRIMARY <span class="keyword">KEY</span>(<span class="keyword">id</span>, <span class="built_in">number</span>)  <span class="comment">#将id和number组合为一个主键</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">test</span> <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;as&#x27;</span>,<span class="string">&#x27;john&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">test</span> <span class="keyword">VALUES</span>(<span class="number">2</span>,<span class="string">&#x27;as&#x27;</span>,<span class="string">&#x27;john&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">test</span> <span class="keyword">VALUES</span>(<span class="number">2</span>,<span class="string">&#x27;as&#x27;</span>,<span class="string">&#x27;mike&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">test</span> <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;as&#x27;</span>,<span class="string">&#x27;john&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">test</span>;</span><br></pre></td></tr></table></figure>

<p>前3条insert语句都能正确执行，第4条则报错。即对于组合的主键，**<span style="color:red">只有组合的几个字段的值都相等才算相同</span><strong>。</strong>组合unique同理**。</p>
<h3 id="关于外键"><a href="#关于外键" class="headerlink" title="关于外键"></a>关于外键</h3><p>外键的一些特点：</p>
<ul>
<li><p>外键是在从表设置的。</p>
</li>
<li><p><strong>从表的外键字段的数据类型与主表的关联列的类型要一致或可兼容</strong>。</p>
</li>
<li><p>主表的关联列必须是一个key，<strong>一般都是主键</strong>，也可以是unique键。eg:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> main_table;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> main_table(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> <span class="keyword">UNIQUE</span> <span class="comment">#unique键</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> forei_table;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> forei_table(</span><br><span class="line">	mainid <span class="built_in">INT</span>,</span><br><span class="line">	fname <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	<span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(mainid) <span class="keyword">REFERENCES</span> main_table(<span class="keyword">id</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>外键字段的值可以为null</strong>，但<strong>要插入值时，在主表的关联字段必须有对应的数据存在，否则不可插入</strong>。</p>
</li>
<li><p><strong><span style="color:red">默认情况下，主表被关联字段的数据的更改或更新操作被拒绝</span></strong>。有以下几个操作可选（<strong>在从表设置外键时在语句的最后添加<code>ON DELETE</code>加上以下字段</strong>）：</p>
<ul>
<li><code>cascade</code>，<strong>级联操作</strong>。主表数据被更新（主键值更新），从表也被更新（外键值更新）。主表记录被删除，从表相关记录也被删除。</li>
<li><code>set null</code>，<strong>置null</strong>。<strong>主表数据被更新（主键值更新），从表的外键被设置为null。主表记录被删除，从表相关记录外键被设置成null</strong>。注意，要求该外键列没有not null属性约束。</li>
<li><code>restrict</code>，拒绝主表的外键关联字段的删除和更新。（<strong>默认</strong>）</li>
</ul>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> stu;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stu(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">	stuname <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	major_id <span class="built_in">INT</span>,</span><br><span class="line">	<span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(major_id) <span class="keyword">REFERENCES</span> major(<span class="keyword">id</span>) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>外键只被InnoDB存储引擎所支持。其他引擎是不支持的</strong>。</p>
</li>
</ul>
<h3 id="关于auto-increment"><a href="#关于auto-increment" class="headerlink" title="关于auto_increment"></a>关于auto_increment</h3><ul>
<li>对有auto_increment约束的字段插入值，比如插入10，那么下一个序号将会是11。</li>
<li><strong>auto_increment必须和key搭配，如主键，唯一键</strong>。</li>
<li>一个表只能有一个auto_increment。</li>
<li>auto_increment只能用于数值型字段。</li>
<li>标识列可以通过<code>SET auto_increment_increment=3;</code>设置步长，也可以通过手动插入值设置起始值。</li>
</ul>
<hr>
<h2 id="MySQL基础-事务"><a href="#MySQL基础-事务" class="headerlink" title="MySQL基础-事务"></a>MySQL基础-事务</h2><p>（以下部分内容摘抄自<a href="https://snailclimb.gitee.io/javaguide/#/docs/database/MySQL" target="_blank">javaGuide博客文档</a>）</p>
<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p>​        <strong>事务是逻辑上的一组操作，即一个或多个SQL语句，要么都执行，要么都不执行</strong>。<strong>如果单元中某条SQL语句一旦执行失败或产生错误，整个单元将会回滚</strong>。所有受到影响的数据将返回到事物开始以前的状态；如果单元中的所有SQL语句均执行成功， 则事物被顺利执行。</p>
<p>​        事务最经典也经常被拿出来说例子就是转账了。假如小明要给小红转账1000元，这个转账会涉及到两个关键操作就是：将小明的余额减少1000元，将小红的余额增加1000元。万一在这两个操作之间突然出现错误比如银行系统崩溃，导致小明余额减少而小红的余额没有增加，这样就不对了。事务就是保证这两个关键操作要么都成功，要么都要失败。</p>
<h3 id="事物的四大特性-ACID"><a href="#事物的四大特性-ACID" class="headerlink" title="事物的四大特性(ACID)"></a>事物的四大特性(ACID)</h3><p><img src="https://gitee.com/bxgitee/noteImage/raw/master/image/20200716162156.png"></p>
<ol>
<li><p><strong>原子性（Atomicity）：</strong> 事务是最小的执行单位，不允许分割。事务的原子性确保动作要么全部完成，要么完全不起作用；</p>
</li>
<li><p><strong>一致性（Consistency）：</strong> 执行事务前后，数据保持一致，多个事务对同一个数据读取的结果是相同的；</p>
<ul>
<li><p><strong>ACID里的AID都是数据库的特征,也就是依赖数据库的具体实现.而唯独这个C,实际上它依赖于应用层,也就是依赖于开发者.这里的一致性是指<font color="red">系统从一个正确的状态,迁移到另一个正确的状态</font>.什么叫正确的状态呢?就是当前的状态满足预定的约束就叫做正确的状态.而事务具备ACID里C的特性是说通过事务的AID来保证我们的一致性</strong>。</p>
<p>（来自<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/31346392/answer/362597203">https://www.zhihu.com/question/31346392/answer/362597203</a> 作者：孟波）</p>
</li>
</ul>
</li>
<li><p><strong>隔离性（Isolation）：</strong> 并发访问数据库时，<strong>一个用户的事务不被其他事务所干扰</strong>，各并发事务之间是独立的；</p>
</li>
<li><p><strong>持久性（Durability）：</strong> 一个事务被提交之后。它对数据库中数据的改变是持久的，即使数据库发生故障也不应该对其有任何影响。</p>
</li>
</ol>
<h3 id="事务的创建"><a href="#事务的创建" class="headerlink" title="事务的创建"></a>事务的创建</h3><p>​        事务可分为隐式事务和显式事务。隐式事务如DML语言（insert、update、delete），每一个语句都是一个事务；而显式事务通过sql语句开启事务跟关闭事务，一个事务可有多条语句。</p>
<p>​        <strong>msyql默认关闭事务，通过<code>SHOW VARIABLES LIKE &#39;%autocommit%&#39;;</code>命令可看到``autocommit=ON`，即自动提交默认开启。创建事务前需关闭自动提交</strong>。<strong><span style="color:red;">事务中不能包括DDL语句</span></strong>。</p>
<p>显示事务的创建：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--1.开启事务</span></span><br><span class="line"><span class="keyword">SET</span> autocommit=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> TRASACTION; <span class="comment">#可选</span></span><br><span class="line"><span class="comment">--编写事务语句</span></span><br><span class="line">语句1</span><br><span class="line">语句2</span><br><span class="line">...</span><br><span class="line"><span class="comment">--结束事务</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure>



<p>一个转账的例子：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先建表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">account</span>(</span><br><span class="line">	username <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	money <span class="keyword">DOUBLE</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">account</span> <span class="keyword">VALUES</span>(<span class="string">&#x27;zhangsan&#x27;</span>, <span class="number">1000</span>),(<span class="string">&#x27;xiaoming&#x27;</span>, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#转账例子</span></span><br><span class="line"><span class="comment">#开启事务（关闭事务自动提交）</span></span><br><span class="line"><span class="keyword">SET</span> autocommit=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">TRANSACTION</span>;</span><br><span class="line"><span class="comment">#事务语句</span></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">account</span> <span class="keyword">SET</span> money=<span class="number">500</span> <span class="keyword">WHERE</span> username=<span class="string">&#x27;zhangsan&#x27;</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">account</span> <span class="keyword">SET</span> money=<span class="number">1500</span> <span class="keyword">WHERE</span> username=<span class="string">&#x27;xiaoming&#x27;</span>;</span><br><span class="line"><span class="comment">#提交事务</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>



<h4 id="回滚点SAVEPOINT"><a href="#回滚点SAVEPOINT" class="headerlink" title="回滚点SAVEPOINT"></a>回滚点SAVEPOINT</h4><p>​        回滚点跟<code>ROLLBACK</code>搭配使用，其作用是设置一个保存点，当执行<code>ROLLBACK</code>时回滚到保存点。</p>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> autocommit=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">TRANSACTION</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">account</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">SAVEPOINT</span> a;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">account</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> a;</span><br></pre></td></tr></table></figure>

<p>执行以上语句后查询account表，可发现只删除了id为2的记录。</p>
<h3 id="事务并发问题"><a href="#事务并发问题" class="headerlink" title="事务并发问题"></a>事务并发问题</h3><p>​        在典型的应用程序中，多个事务并发运行，经常会操作相同的数据来完成各自的任务（<strong>多个用户对同一数据进行操作</strong>）。并发虽然是必须的，但可能会导致以下的问题。</p>
<ul>
<li><p><strong>脏读（Dirty read）:</strong> <strong>当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的</strong>，比如可能出现错误而回滚事务，导致修改后的数据没有存入数据库。</p>
</li>
<li><p><strong>丢失修改（Lost to modify）:</strong> <strong>指在一个事务读取一个数据时，另外一个事务也访问了该数据，那么在第一个事务中修改了这个数据后，第二个事务也修改了这个数据。这样第一个事务内的修改结果就被丢失，因此称为丢失修改</strong>。 例如：</p>
<ul>
<li><p>事务1读取某表中的数据A=20，事务2也读取A=20，事务1修改A=A-1，事务2也修改A=A-1，最终结果A=19，事务1的修改被丢失。（<strong>即结果应该是A=18，但因为事务2的修改覆盖了事务1的修改，使事务1丢失</strong>）</p>
</li>
<li><p>考虑飞机订票系统中的一个活动序列: </p>
<ol>
<li>甲售票点（甲事务）读出某航班的机票余额A,设A=16. </li>
<li>乙售票点（乙事务）读出同一航班的机票余额A,也为16. </li>
<li>甲售票点卖出一张机票,修改余额A←A-1.所以A为15,把A写回数据库. </li>
<li>乙售票点也卖出一张机票,修改余额A←A-1.所以A为15,把A写回数据库. </li>
</ol>
<p><strong><span style="color:red">结果明明卖出两张机票，数据库中机票余额只减少1</span></strong>。 </p>
</li>
</ul>
</li>
<li><p><strong>不可重复读（Unrepeatableread）:</strong> <strong>指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的结果可能不一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读</strong>。（事务1读数据的过程中，事务2把数据给改了，导致事务1两次读的数据不同）</p>
</li>
<li><p><strong>幻读（Phantom read）:</strong> 幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，<strong>第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读</strong>。（<strong>在同一事务下，连续执行两次同样的SQL语句第二次的SQL语句可能返回之前不存在的行</strong>）</p>
</li>
</ul>
<p><strong><span style="color:red">不可重复读和幻读区别</span></strong>： </p>
<p><strong>不可重复读的重点是数据的值被修改，比如多次读取一条记录发现其中某些列的值被修改</strong>，幻读的重点在于<strong>新增或者删除比如多次读取一条记录发现记录增多或减少了</strong>。</p>
<h3 id="MySQL的事务隔离级别"><a href="#MySQL的事务隔离级别" class="headerlink" title="MySQL的事务隔离级别"></a>MySQL的事务隔离级别</h3><p><strong><span style="color:red">SQL 标准定义了四个隔离级别：</span></strong> </p>
<ul>
<li><strong>READ-UNCOMMITTED(读取未提交)：</strong> 最低的隔离级别，允许读取尚未提交的数据变更，<strong><span style="color:red">可能会导致脏读、幻读或不可重复读</span></strong>。</li>
<li><strong>READ-COMMITTED(读取已提交)：</strong> 允许读取并发事务已经提交的数据，<strong><span style="color:red">可以阻止脏读，但是幻读或不可重复读仍有可能发生</span></strong>。</li>
<li><strong>REPEATABLE-READ(可重复读)：</strong> <strong>对同一字段的多次读取结果都是一致的</strong>，除非数据是被本身事务自己所修改，<span style="color:red"><strong>可以阻止脏读和不可重复读，但幻读仍有可能发生</strong></span>。</li>
<li><strong>SERIALIZABLE(可串行化)：</strong> <strong>最高的隔离级别，完全服从ACID的隔离级别</strong>。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，<strong>该级别可以防止脏读、不可重复读以及幻读</strong>。但效率极低。该标准类似于线程锁。</li>
</ul>
<p>可总结为下表（<strong>打勾表示可能发生</strong>）</p>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻影读</th>
</tr>
</thead>
<tbody><tr>
<td>READ-UNCOMMITTED</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>READ-COMMITTED</td>
<td>×</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>REPEATABLE-READ</td>
<td>×</td>
<td>×</td>
<td>√</td>
</tr>
<tr>
<td>SERIALIZABLE</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
</tbody></table>
<p>MySQL <strong>InnoDB 存储引擎</strong>的默认支持的隔离级别是 <strong>REPEATABLE-READ（可重读）</strong>。可以<strong>通过<code>SELECT @@tx_isolation;</code>命令</strong>来查看</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT @@tx_isolation;</span><br><span class="line">+<span class="comment">-----------------+</span></span><br><span class="line">| @@tx_isolation  |</span><br><span class="line">+<span class="comment">-----------------+</span></span><br><span class="line">| REPEATABLE-READ |</span><br><span class="line">+<span class="comment">-----------------+</span></span><br></pre></td></tr></table></figure>



<p>​        <strong><span style="color:red">这里需要注意的是</span></strong>：与 SQL 标准不同的地方在于 InnoDB 存储引擎在 <strong>REPEATABLE-READ（可重读）</strong> 事务隔离级别下使用的是<strong>Next-Key Lock 锁算法</strong>，因此<strong><span style="color:red">可以避免幻读的产生</span></strong>，这与其他数据库系统(如 SQL Server) 是不同的。所以说<strong><span style="color:red">InnoDB 存储引擎的默认支持的隔离级别已经可以完全保证事务的隔离性要求，即达到了 SQL标准的 SERIALIZABLE(可串行化) 隔离级别</span></strong>。因为隔离级别越低，事务请求的锁越少，所以大部分数据库系统的隔离级别都是 <strong>READ-COMMITTED(读取提交内容)</strong> ，<strong>但是InnoDB 存储引擎默认使用 REPEAaTABLE-READ（可重读），<span style="color:red"> 并不会有任何性能损失</span></strong>。</p>
<p>InnoDB 存储引擎在 <strong>分布式事务</strong> 的情况下一般会用到 <strong>SERIALIZABLE(可串行化)</strong> 隔离级别。</p>
<p>设置事务隔离级别：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">SESSION</span>/<span class="keyword">GLOBAL</span> <span class="keyword">TRANSACTION</span> <span class="keyword">ISOLATION</span> <span class="keyword">LEVEL</span> </span><br><span class="line"><span class="keyword">read</span> uncommitted | <span class="keyword">read</span> committed | repeatable <span class="keyword">read</span>(默认) | <span class="keyword">serializable</span>;</span><br></pre></td></tr></table></figure>



<h3 id="锁机制与InnoDB锁算法（to-be-continue）"><a href="#锁机制与InnoDB锁算法（to-be-continue）" class="headerlink" title="锁机制与InnoDB锁算法（to be continue）"></a>锁机制与InnoDB锁算法（to be continue）</h3><h2 id="MySQL基础-视图"><a href="#MySQL基础-视图" class="headerlink" title="MySQL基础-视图"></a>MySQL基础-视图</h2><h3 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h3><p>（部分摘抄自<a target="_blank" rel="noopener" href="https://shockerli.net/post/1000-line-mysql-note/%EF%BC%89">https://shockerli.net/post/1000-line-mysql-note/）</a></p>
<p>​        视图是一个虚拟表，其内容由查询定义。同真实的表一样，<strong>视图包含一系列带有名称的列和行数据</strong>。但是，<strong>视图并不在数据库中以存储的数据值集形式存在</strong>。行和列数据来自由定义视图的查询所引用的表，<strong>并且在引用视图时动态生成</strong>。    </p>
<p>​        <strong>视图具有表结构文件，但不存在数据文件</strong>。对其中所引用的基础表来说，视图的作用类似于筛选。通过视图进行查询没有任何限制，通过它们进行数据修改时的限制也很少。视图是存储在数据库中的查询的sql语句，它主要出于两种原因：<strong>安全原因</strong>，视图可以隐藏一些数据，如：社会保险基金表，可以用视图只显示姓名，地址，而不显示社会保险号和工资数等，另一原因是可<strong>使复杂的查询易于理解和使用</strong>。</p>
<p>​        可简单的这样理解：<strong>视图存储的是sq逻辑，即sql语句，当要使用视图时根据该语句动态生成结果集</strong>。</p>
<h3 id="视图的创建和使用"><a href="#视图的创建和使用" class="headerlink" title="视图的创建和使用"></a>视图的创建和使用</h3><p>创建视图的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view_name</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">查询语句; <span class="comment">-- 一般是涉及多个表的复杂的查询语句</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view_name; <span class="comment">-- 显示视图结构</span></span><br></pre></td></tr></table></figure>

<p>创建视图后，使用视图类似于使用表。</p>
<p>eg:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myv1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.department_id=d.department_id</span><br><span class="line"><span class="keyword">JOIN</span> jobs j <span class="keyword">ON</span> j.job_id = e.job_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> myv1 <span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="视图的修改"><a href="#视图的修改" class="headerlink" title="视图的修改"></a>视图的修改</h3><p>两种方式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1(如果视图不存在会创建；视图存在就代替)</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">VIEW</span> view_name</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">查询语句;</span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">VIEW</span> myv1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,d.manager_id,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.department_id=d.department_id</span><br><span class="line"><span class="keyword">JOIN</span> jobs j <span class="keyword">ON</span> j.job_id = e.job_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> view_name</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">查询语句;</span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> myv1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.department_id=d.department_id</span><br><span class="line"><span class="keyword">JOIN</span> jobs j <span class="keyword">ON</span> j.job_id = e.job_id;</span><br></pre></td></tr></table></figure>



<h3 id="视图的删除和查看"><a href="#视图的删除和查看" class="headerlink" title="视图的删除和查看"></a>视图的删除和查看</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> view1_name,view2_name...;</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看结构</span></span><br><span class="line">DESC view_name;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view_name;</span><br></pre></td></tr></table></figure>



<h3 id="视图更新"><a href="#视图更新" class="headerlink" title="视图更新"></a>视图更新</h3><p>​        <strong>视图的可更新性和视图中查询的定义有关系</strong>，<strong>以下类型的视图是不能更新的</strong></p>
<ul>
<li>包含以下关键字的sql语句：分组函数、distinct、group by、having、union或者uunion all</li>
<li>常量视图</li>
<li>Select中包含子查询</li>
<li>Join</li>
<li>from一个不能更新的视图</li>
<li>where子句的子查询引用了from子句中的表</li>
</ul>
<p><strong>一般情况下视图都是不可更新的</strong>。</p>
<p>可更新视图的简单示例：tips：<strong>更新会作用到原表</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myv3</span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line"><span class="keyword">SELECT</span> last_name, phone_number</span><br><span class="line"><span class="keyword">FROM</span> employees ;</span><br><span class="line"></span><br><span class="line"><span class="comment">#insert</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myv3 <span class="keyword">VALUES</span>(<span class="string">&#x27;许褚&#x27;</span>,<span class="string">&#x27;888888&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#update</span></span><br><span class="line"><span class="keyword">UPDATE</span> myv3 <span class="keyword">SET</span> last_name=<span class="string">&#x27;典韦&#x27;</span> <span class="keyword">WHERE</span> last_name=<span class="string">&#x27;许褚&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#delete</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> myv3 <span class="keyword">WHERE</span> last_name=<span class="string">&#x27;典韦&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>对视图进行修改需要有权限。</p>
<h3 id="视图与表"><a href="#视图与表" class="headerlink" title="视图与表"></a>视图与表</h3><ul>
<li>两者创建的语法不同。</li>
<li>从占用存储空间方面：<strong>视图只是保存了sql语句，只占用了很小的空间；而表保存了数据，占用空间较大</strong>。</li>
<li>视图一般都不允许增删改查；表允许。</li>
</ul>
<hr>
<h2 id="MySQL基础-变量"><a href="#MySQL基础-变量" class="headerlink" title="MySQL基础-变量"></a>MySQL基础-变量</h2><p>MySQL变量的分类：</p>
<ul>
<li>系统变量<ul>
<li>全局变量</li>
<li>会话变量</li>
</ul>
</li>
<li>自定义变量<ul>
<li>用户变量</li>
<li>局部变量</li>
</ul>
</li>
</ul>
<h3 id="系统变量"><a href="#系统变量" class="headerlink" title="系统变量"></a>系统变量</h3><p>​        系统变量是由MySQL系统提供的，用于设置服务器的某些功能。<strong>分为全局（global）变量和会话（session）变量</strong>。两者主要区别是作用域不同，<strong>全局变量的作用域是所有会话（连接），<span style="color:red">但每次重启MySQL服务器都会重置</span>；而会话变量只针对当前会话有效</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--（对于会话变量，session可省略）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--查看所有全局/会话变量</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span>|<span class="keyword">SESSION</span> <span class="keyword">VARIABLES</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--添加筛选条件</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> condition;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看单个变量</span></span><br><span class="line"><span class="keyword">SELECT</span> @@<span class="keyword">global</span>|[<span class="keyword">session</span>].变量名</span><br><span class="line"></span><br><span class="line"><span class="comment">--修改</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span>|<span class="keyword">SESSION</span> 变量名=new_value;</span><br><span class="line"><span class="keyword">SET</span> @@<span class="keyword">global</span>|[<span class="keyword">session</span>].变量名=new_value;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">&#x27;%tx_is%&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> @@global.autocommit;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">&#x27;%char%&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="自定义变量"><a href="#自定义变量" class="headerlink" title="自定义变量"></a>自定义变量</h3><p><strong>用户变量针对当前会话有效</strong>，即与会话变量作用域相同。<strong>用户变量可以应用在begin-end里面以及外面</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--声明(变量名使用@开头，避免与系统变量产生冲突)</span></span><br><span class="line"><span class="keyword">SET</span> @variable_name=<span class="keyword">value</span>;</span><br><span class="line"><span class="keyword">SET</span> @variable_name:=<span class="keyword">value</span>;</span><br><span class="line"><span class="keyword">SELECT</span> @variable_name:=<span class="keyword">value</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--修改（与声明同）</span></span><br><span class="line"><span class="comment">--1</span></span><br><span class="line"><span class="keyword">SET</span> @variable_name=<span class="keyword">value</span>;</span><br><span class="line"><span class="keyword">SET</span> @variable_name:=<span class="keyword">value</span>;</span><br><span class="line"><span class="keyword">SELECT</span> @variable_name:=<span class="keyword">value</span>;</span><br><span class="line"><span class="comment">--2</span></span><br><span class="line"><span class="keyword">SELECT</span> column_name(只能有一个字段) <span class="keyword">INTO</span> @variable_name</span><br><span class="line"><span class="keyword">FROM</span> table_name [<span class="keyword">where</span> ...]</span><br><span class="line"></span><br><span class="line"><span class="comment">--使用</span></span><br><span class="line"><span class="keyword">SELECT</span> @variable_name;</span><br></pre></td></tr></table></figure>



<p><strong>局部变量只在begin-end块中有效</strong>。在块的开头声明。一般不使用@。<strong>局部变量应用在存储过程、函数等</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--声明(可不加@)</span></span><br><span class="line"><span class="keyword">DECLARE</span> variable_name DATATYPE [<span class="keyword">DEFAULT</span> <span class="keyword">value</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">--修改</span></span><br><span class="line"><span class="comment">--1(使用select加@)</span></span><br><span class="line"><span class="keyword">SET</span> variable_name=<span class="keyword">value</span>;</span><br><span class="line"><span class="keyword">SET</span> variable_name:=<span class="keyword">value</span>;</span><br><span class="line"><span class="keyword">SELECT</span> @variable_name:=<span class="keyword">value</span>;</span><br><span class="line"><span class="comment">--2</span></span><br><span class="line"><span class="keyword">SELECT</span> column_name(只能有一个字段) <span class="keyword">INTO</span> variable_name</span><br><span class="line"><span class="keyword">FROM</span> table_name [<span class="keyword">where</span> ...]</span><br><span class="line"></span><br><span class="line"><span class="comment">--使用</span></span><br><span class="line"><span class="keyword">SELECT</span> variable_name;</span><br></pre></td></tr></table></figure>



<p>eg：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--user variable</span><br><span class="line">SET @m&#x3D;1;</span><br><span class="line">SET @n&#x3D;2;</span><br><span class="line">SET @sum&#x3D;@m+@n;</span><br><span class="line">SELECT @sum;</span><br><span class="line"></span><br><span class="line">--局部变量</span><br><span class="line">。。</span><br></pre></td></tr></table></figure>



<h2 id="MySQL基础-存储过程"><a href="#MySQL基础-存储过程" class="headerlink" title="MySQL基础-存储过程"></a>MySQL基础-存储过程</h2><p>​        存储过程是一段可执行性sql代码的集合。相比函数，更偏向于业务逻辑。实际上存储过程即类似于Java中的方法。</p>
<p>关于<code>DELIMITER</code>：<strong>该关键字用于指定命令结束符号，即告诉MySQL当遇见结束符时表示命令结束，可以执行</strong>。默认情况下是<code>;</code>。<strong>在某些情况下</strong>，不止要执行一条SQL语句，但又需要<code>;</code>作为各语句的结束，这时可使用该关键字指定其他的结束符。下面的存储过程创建即使用了这一点。</p>
<p><strong>创建存储过程前需要先使用<code>DELIMITER</code>关键字指定除<code>;</code>外的结束符</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--语法</span></span><br><span class="line"><span class="comment">--若过程体只有一句SQL语句，begin-end可以省略</span></span><br><span class="line"><span class="comment">--过程体的每条SQL语句必须以分号结尾</span></span><br><span class="line">DELIMITER $(可使用其他符号)</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> 过程名 (参数列表)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    过程体</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="comment">--参数列表的每个参数定义包含3个部分</span></span><br><span class="line"><span class="keyword">IN</span>|<span class="keyword">OUT</span>|INOUT 参数名 数据类型</span><br><span class="line"><span class="comment">--其中</span></span><br><span class="line"><span class="keyword">IN</span>      输入：在调用过程中，将数据输入到过程体内部的参数</span><br><span class="line"><span class="keyword">OUT</span>     输出：在调用过程中，将过程体处理完的结果返回到客户端</span><br><span class="line">INOUT   输入输出：既可输入，也可输出</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--调用</span></span><br><span class="line"><span class="keyword">CALL</span> 存储过程名(实参列表)</span><br><span class="line"></span><br><span class="line"><span class="comment">--删除存储过程</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> procedure_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看存储过程的结构</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> procedure_name;</span><br></pre></td></tr></table></figure>



<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> insert_to_major()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">INSERT</span> <span class="keyword">INTO</span> major <span class="keyword">VALUES</span>(<span class="number">4</span>,<span class="string">&#x27;a&#x27;</span>),(<span class="number">5</span>,<span class="string">&#x27;b&#x27;</span>),(<span class="number">6</span>,<span class="string">&#x27;c&#x27;</span>),(<span class="number">7</span>,<span class="string">&#x27;d&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> insert_to_major();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--判断登录是否成功</span></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> login(<span class="keyword">IN</span> username <span class="built_in">VARCHAR</span>(<span class="number">10</span>),<span class="keyword">IN</span> <span class="keyword">password</span> <span class="built_in">VARCHAR</span>(<span class="number">10</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="keyword">result</span> <span class="built_in">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">INTO</span> <span class="keyword">result</span></span><br><span class="line">	<span class="keyword">FROM</span> <span class="keyword">admin</span> <span class="keyword">WHERE</span> admin.<span class="string">`username`</span>=username <span class="keyword">AND</span> admin.<span class="string">`password`</span>=<span class="keyword">password</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">IF</span>(<span class="keyword">result</span>&gt;<span class="number">0</span>,<span class="string">&#x27;登录成功&#x27;</span>,<span class="string">&#x27;登录失败&#x27;</span>) <span class="string">&#x27;登录情况&#x27;</span>;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> login(<span class="string">&#x27;吴彦祖&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--根据女神名获取男朋友名字（使用了in out）</span></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_boyfriend(<span class="keyword">IN</span> girl_name <span class="built_in">VARCHAR</span>(<span class="number">10</span>),<span class="keyword">OUT</span> boyfriend <span class="built_in">VARCHAR</span>(<span class="number">10</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> bo.boyName <span class="keyword">INTO</span> boyfriend</span><br><span class="line">	<span class="keyword">FROM</span> boys bo </span><br><span class="line">	<span class="keyword">INNER</span> <span class="keyword">JOIN</span> beauty b <span class="keyword">ON</span> b.boyfriend_id=bo.id</span><br><span class="line">	<span class="keyword">WHERE</span> b.name=girl_name;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> @bname = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">CALL</span> get_boyfriend(<span class="string">&#x27;王语嫣&#x27;</span>,@bname);</span><br><span class="line"><span class="keyword">SELECT</span> @bname;</span><br></pre></td></tr></table></figure>







<h2 id="MySQL基础-函数"><a href="#MySQL基础-函数" class="headerlink" title="MySQL基础-函数"></a>MySQL基础-函数</h2><h3 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h3><p>MySQL的函数有系统自带（内置函数）的，<strong>也可以自定义函数</strong>。函数于存储体类似，都是一组SQL语句的集合。</p>
<p><strong>其与存储体的区别如下</strong>：</p>
<ul>
<li>存储体可以有0或多个返回值。适合批量操作。</li>
<li>函数有且仅有一个返回值。适合用于对数据处理后返回一个数据。</li>
</ul>
<p>(部分摘抄自<a target="_blank" rel="noopener" href="https://shockerli.net/post/1000-line-mysql-note/">https://shockerli.net/post/1000-line-mysql-note/</a>)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建函数</span></span><br><span class="line">DELIMITER $(可使用其他符号)</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> function_name (参数列表) <span class="keyword">RETURNS</span> 返回值类型</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	函数体</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">- 函数名，应该合法的标识符，并且不应该与已有的关键字冲突。</span><br><span class="line">- 一个函数应该属于某个数据库，可以使用db_name.funciton_name的形式执行当前函数所属数据库，否则为当前数据库。</span><br><span class="line">- 参数部分，由<span class="string">&quot;参数名&quot;</span>和<span class="string">&quot;参数类型&quot;</span>组成。多个参数用逗号隔开。</span><br><span class="line">- 函数体由多条可用的mysql语句，流程控制，变量声明等语句构成。</span><br><span class="line">- 若函数体只有一条语句，可以省略<span class="keyword">begin</span>-<span class="keyword">end</span></span><br><span class="line">- 必须有 <span class="keyword">return</span> 返回值语句。</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用</span></span><br><span class="line"><span class="keyword">SELECT</span> function_name(实参列表);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> [<span class="keyword">IF</span> <span class="keyword">EXISTS</span>] function_name;</span><br><span class="line">    </span><br><span class="line"><span class="comment">-- 查看</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FUNCTION</span> <span class="keyword">STATUS</span> <span class="keyword">LIKE</span> <span class="string">&#x27;partten&#x27;</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> function_name;</span><br><span class="line">    </span><br><span class="line"><span class="comment">-- 修改</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">FUNCTION</span> function_name 函数选项</span><br></pre></td></tr></table></figure>



<p>eg:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#根据员工名获取工资</span></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getsal(empName <span class="built_in">VARCHAR</span>(<span class="number">10</span>)) <span class="keyword">RETURNS</span> <span class="keyword">DOUBLE</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SET</span> @sal = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">INTO</span> @sal</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name=empName;</span><br><span class="line">	</span><br><span class="line">	RETURN @sal;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> getsal(<span class="string">&#x27;Hunold&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h3 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h3><p>​        MySQL内置函数有单行函数和分组函数：</p>
<ul>
<li><strong>单行函数</strong>：作用范围只有一行，即一个记录。</li>
<li><strong>分组函数</strong>：<strong>作用的范围是多个记录（即一列）</strong>，对多个记录进行统计，再返回一个结果。又称统计函数。</li>
</ul>
<h4 id="单行函数-字符函数"><a href="#单行函数-字符函数" class="headerlink" title="单行函数-字符函数"></a>单行函数-字符函数</h4><p><strong><span style="font-size:25px;"><code>LENGTH(str)</code></span></strong> </p>
<p>返回str的长度（字节数），其中，若使用的是<strong>utf8字符集</strong>，<strong>则一个英文占1个字节，一个中文占3个字节</strong>。</p>
<p>eg：</p>
<p><code>SELECT LENGTH(&#39;不摇碧莲&#39;);</code> 返回12.<br><code>SELECT LENGTH(&#39;jonh&#39;);</code>  返回4.</p>
<p><code>----------------------------------------------------------------------------------</code> </p>
<p><strong><span style="font-size:25px;"><code>UPPER(str)</code>、<code>LOWER(str)</code></span></strong> </p>
<p>转化为大写、小写。eg：</p>
<p><code>SELECT UPPER(&#39;john&#39;); </code><br><code>SELECT LOWER(&#39;MIKE&#39;);</code> </p>
<p><code>----------------------------------------------------------------------------------</code> </p>
<p><strong><span style="font-size:25px;"><code>CONCAT(str1,str2,...)</code></span></strong> </p>
<p>拼接字符。</p>
<p><code>SELECT CONCAT(last_name,&#39;_&#39;,first_name) &#39;name&#39; FROM employees;</code><br><code>SELECT CONCAT(LOWER(last_name),&#39;_&#39;,UPPER(first_name)) &#39;name&#39; FROM employees;</code> （函数嵌套）</p>
<p><code>----------------------------------------------------------------------------------</code> </p>
<p><strong><span style="font-size:25px;"><code>SUBSTR substring</code></span></strong> </p>
<p><strong>该函数有4个重载的形式。<span style="color:red">sql中的索引从1开始</span></strong>。</p>
<p><code>substr(str,start)</code>：</p>
<p><code>substr(str FROM pos)</code>     返回从pos开始的子字符串</p>
<p><code>substr(str, pos, length)</code>     返回从索引pos开始，长度为length的子字符串</p>
<p><code>substr(str FROM pos FOR length)</code> </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUBSTR</span>(<span class="string">&#x27;一二三四五六&#x27;</span>,<span class="number">4</span>) <span class="keyword">output</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUBSTR</span>(<span class="string">&#x27;一二三四五六&#x27;</span> <span class="keyword">FROM</span> <span class="number">3</span>) <span class="keyword">output</span>;  <span class="comment">#三四五六</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUBSTR</span>(<span class="string">&#x27;一二三四五六&#x27;</span>,<span class="number">1</span>,<span class="number">4</span>) <span class="keyword">output</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUBSTR</span>(<span class="string">&#x27;一二三四五六&#x27;</span> <span class="keyword">FROM</span> <span class="number">1</span> <span class="keyword">FOR</span> <span class="number">3</span>) <span class="keyword">output</span>;</span><br></pre></td></tr></table></figure>

<p><code>----------------------------------------------------------------------------------</code> </p>
<p><strong><span style="font-size:25px;"><code>INSTR(str,substr)</code></span></strong> </p>
<p><strong>返回子串第一次出现的位置，若不包含该子串，返回0</strong>。</p>
<p><code>SELECT INSTR(&#39;一二三四五六&#39;, &#39;四五六&#39;) output; #4</code><br><code>SELECT INSTR(&#39;一二三四五六&#39;, &#39;四六&#39;) output; #0</code> </p>
<p><code>----------------------------------------------------------------------------------</code> </p>
<p><strong><span style="font-size:25px;"><code>TRIM([deleteStr] FROM str)</code></span></strong> </p>
<p><strong>去掉前后的空格或指定字符（中间的字符不受影响）</strong>。eg：</p>
<p><code>SELECT TRIM(&#39;     啊哈哈哈   &#39;) output;</code><br><code>SELECT TRIM(&#39;a&#39; FROM &#39;aaaaa啊哈哈aaa&#39;) output;</code> </p>
<p><code>----------------------------------------------------------------------------------</code> </p>
<p><strong><span style="font-size:25px;"><code>LPAD(str,length,padstr) </code></span></strong> </p>
<p><strong>用padstr对str进行左填充达到length长度</strong>。<code>rpad()</code>同理。</p>
<p>eg：</p>
<p><code>SELECT LPAD(&#39;张三&#39;,10,&#39;a&#39;) output;</code>  # aaaaaaaa张三</p>
<p><code>SELECT RPAD(&#39;张三&#39;,10,&#39;a&#39;) output;</code>  # 张三aaaaaaaa</p>
<p>**其中，若是length参数小于str的长度，相当于substr(str,1,length)**，对lpad、rpad都一样。eg：</p>
<p><code>SELECT LPAD(&#39;张三四&#39;,2,&#39;a&#39;) output;</code>  # 张三</p>
<p><code>SELECT RPAD(&#39;张三四&#39;,2,&#39;a&#39;) output;</code>  # 张三</p>
<p><code>----------------------------------------------------------------------------------</code> </p>
<p><strong><span style="font-size:25px;"><code>REPLACE(str,fromStr,toStr) </code></span></strong> </p>
<p>替换。eg：</p>
<p><code>SELECT REPLACE(&#39;小明爱上了小红&#39;,&#39;小红&#39;,&#39;小绿&#39;) output;</code>  #小红爱上了小绿</p>
<h4 id="单行函数-数字函数"><a href="#单行函数-数字函数" class="headerlink" title="单行函数-数字函数"></a>单行函数-数字函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#四舍五入</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">ROUND</span>(<span class="number">1.56</span>) <span class="keyword">output</span>; <span class="comment"># 2</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">ROUND</span>(<span class="number">-1.54</span>) <span class="keyword">output</span>; <span class="comment">#-2</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">ROUND</span>(<span class="number">1.567</span>, <span class="number">2</span>) <span class="keyword">output</span>; <span class="comment"># 1.57</span></span><br><span class="line"><span class="comment">#向上取整</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CEIL</span>(<span class="number">1.2</span>) <span class="keyword">output</span>; <span class="comment">#2</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CEIL</span>(<span class="number">-1.1</span>) <span class="keyword">output</span>; <span class="comment"># -1</span></span><br><span class="line"><span class="comment">#向下取整</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FLOOR</span>(<span class="number">1.2</span>) <span class="keyword">output</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FLOOR</span>(<span class="number">-1.2</span>) <span class="keyword">output</span>; <span class="comment"># -2</span></span><br><span class="line"><span class="comment">#截断</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">TRUNCATE</span>(<span class="number">1.1999</span>,<span class="number">1</span>) <span class="keyword">output</span>; <span class="comment"># 1.1，没有四舍五入</span></span><br><span class="line"><span class="comment">#模运算</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MOD</span>(<span class="number">10</span>,<span class="number">3</span>) <span class="keyword">output</span>; <span class="comment">#10%3</span></span><br><span class="line"><span class="comment">#生成0-1的任意数以及0-100的任意数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RAND</span>(),<span class="keyword">RAND</span>()*<span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<h4 id="单行函数-日期函数"><a href="#单行函数-日期函数" class="headerlink" title="单行函数-日期函数"></a>单行函数-日期函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#返回当前系统日期+时间</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">NOW</span>() <span class="string">&#x27;time&#x27;</span>;</span><br><span class="line"><span class="comment">#返回当前系统日期</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CURDATE</span>() <span class="string">&#x27;time&#x27;</span>;</span><br><span class="line"><span class="comment">#返回当前系统时间</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CURTIME</span>() <span class="string">&#x27;time&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#截取日期中的年、月、日day、小时hour、分min?、秒second</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(<span class="keyword">NOW</span>()) <span class="string">&#x27;year&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(<span class="string">&quot;1998-12-12&quot;</span>) <span class="string">&#x27;year&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(hiredate) <span class="string">&#x27;year&#x27;</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MINUTE</span>(<span class="keyword">NOW</span>()) <span class="string">&#x27;minute&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MONTH</span>(<span class="keyword">NOW</span>()) <span class="string">&#x27;month&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> MONTHNAME(<span class="keyword">NOW</span>()) <span class="string">&#x27;monthname&#x27;</span>; <span class="comment"># 获取月的英文名称</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将字符串根据指定格式转化为日期，具体格式见下表</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">STR_TO_DATE</span>(<span class="string">&#x27;1999-10-22&#x27;</span>,<span class="string">&#x27;%Y-%m-%d&#x27;</span>) <span class="keyword">output</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> hiredate=<span class="keyword">STR_TO_DATE</span>(<span class="string">&#x27;4-3 1992&#x27;</span>,<span class="string">&#x27;%c-%d %Y&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#将日期根据指定格式转化为字符，</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATE_FORMAT</span>(<span class="keyword">NOW</span>(),<span class="string">&#x27;%Y年%m月%d日&#x27;</span>) <span class="keyword">output</span>;</span><br><span class="line"><span class="comment">#查询有奖金的员工名跟入职日期(xx月/xx日 xx年的格式)</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name, <span class="keyword">DATE_FORMAT</span>(hiredate,<span class="string">&#x27;%m月/%d日 %Y年&#x27;</span>) <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>; </span><br><span class="line"><span class="comment">#计算两个日期之间相差的天数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATEDIFF</span>(<span class="keyword">MAX</span>(hiredate),<span class="keyword">MIN</span>(hiredate)) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>



<img src="https://gitee.com/bxgitee/noteImage/raw/master/image/image-20200526104150723.png" alt="image-20200526104150723" style="zoom: 50%;" />



<h4 id="单行函数-其他函数"><a href="#单行函数-其他函数" class="headerlink" title="单行函数-其他函数"></a>单行函数-其他函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">VERSION</span>();<span class="comment">#当前版本</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATABASE</span>();<span class="comment">#当前数据库名</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>(); <span class="comment">#当前用户名</span></span><br><span class="line"><span class="comment">#返回字符串的加密形式、md5加密形式</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">PASSWORD</span>(<span class="string">&#x27;objk&#x27;</span>),<span class="keyword">MD5</span>(<span class="string">&#x27;ojbk&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--若exp1为null，返回exp2值，否则返回exp1的值。</span></span><br><span class="line">IFNULL(exp1, exp2)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 若expr为真，返回1，否则0</span></span><br><span class="line">isnull(expr)</span><br></pre></td></tr></table></figure>



<h4 id="单行函数-流程控制函数"><a href="#单行函数-流程控制函数" class="headerlink" title="单行函数-流程控制函数"></a>单行函数-流程控制函数</h4><p><strong><span style="font-size:25px;"><code>if(condition,expr1,expr2)</code></span></strong> </p>
<p><strong>若条件为真，返回expr1，否则返回expr2</strong>。</p>
<p>eg：</p>
<p><code>SELECT last_name,IF(commission_pct IS NOT NULL,&#39;有奖金&#39;,&#39;没奖金&#39;) 备注 FROM employees;</code> </p>
<h4 id="分组函数"><a href="#分组函数" class="headerlink" title="分组函数"></a>分组函数</h4><p>常见的分组函数有：</p>
<p><strong><code>sum(expr)</code> 求和 </strong></p>
<p><strong><code>avg(expr)</code> 求平均值 </strong></p>
<p><strong><code>max(expr)</code> 求最大值 </strong></p>
<p><strong><code>min(expr)</code> 求最小值 </strong></p>
<p><strong><code>count(expr)</code> 求数量</strong> </p>
<p>其中：</p>
<ul>
<li><strong>分组函数的参数一般为字段名</strong>。</li>
<li>sum、avg一般<strong>只接受数值型参数</strong>，max、min、count<strong>可接受任何类型的参数</strong>。</li>
<li><strong>5个函数对null值忽略</strong>，即对null值不统计、不计算。</li>
<li>可与<code>distinct</code>配合使用，<strong>会对结果先去重，再进行函数计算</strong>。</li>
<li><strong>与分组函数一同查询的字段应有限制（分组函数查询结果只有一个值，而查询字段可能会有多个值），一般要求是<code>group by</code>后的字段</strong>。</li>
</ul>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(salary) <span class="string">&#x27;sum&#x27;</span>,<span class="keyword">AVG</span>(salary) <span class="string">&#x27;average&#x27;</span>,<span class="keyword">MIN</span>(salary) <span class="string">&#x27;min&#x27;</span>,<span class="keyword">MAX</span>(salary) <span class="string">&#x27;max&#x27;</span>,<span class="keyword">COUNT</span>(salary) <span class="string">&#x27;count&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(last_name),<span class="keyword">MIN</span>(last_name) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(hiredate),<span class="keyword">MIN</span>(hiredate) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(<span class="keyword">DISTINCT</span> salary) 去重,<span class="keyword">SUM</span>(salary) 不去重 <span class="keyword">FROM</span> employees;<span class="comment">##</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> commission_pct),<span class="keyword">COUNT</span>(commission_pct) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>



<p><strong><code>COUNT()</code>函数</strong> </p>
<p>​        在5个函数中，<code>count()</code>函数有些许不同。</p>
<p>​        <strong>可使用<code>count(*)</code>跟<code>count(1)</code>来统计一个表有多少个记录。使用后者相当于在每个记录中添加一个名为1的字段（即新添加一个列），并统计共有多少行</strong>。</p>
<p>tips：myisam引擎下，<code>count(*)</code>效率更高；innodb引擎下，两者效率相差不多。</p>
<h2 id="MySQL基础-流程控制"><a href="#MySQL基础-流程控制" class="headerlink" title="MySQL基础-流程控制"></a>MySQL基础-流程控制</h2><h3 id="分支结构"><a href="#分支结构" class="headerlink" title="分支结构"></a>分支结构</h3><h4 id="if函数"><a href="#if函数" class="headerlink" title="if函数"></a>if函数</h4><p>见<code>函数\内置函数</code>第5点。</p>
<h4 id="case-when"><a href="#case-when" class="headerlink" title="case..when"></a><code>case..when</code></h4><p><strong>该语法有两种使用形式，可嵌套在select中（此时整个case-when执行后返回一个值），也可单独使用</strong>。</p>
<p>**第一钟类似Java的<code>swich..case</code>**。具体语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">case 要判断的字段、表达式</span><br><span class="line"></span><br><span class="line">when 常量1 then 要显示的值1或语句1;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">when 常量n then 要显示的值n或语句n;</span><br><span class="line"></span><br><span class="line">else 默认显示</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<p>eg，根据部门id的不同，显示不同的最终工资：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,salary 原工资,department_id,</span><br><span class="line"><span class="keyword">CASE</span> department_id</span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">30</span> <span class="keyword">THEN</span> salary*<span class="number">1.1</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">40</span> <span class="keyword">THEN</span> salary*<span class="number">1.2</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">50</span> <span class="keyword">THEN</span> salary*<span class="number">1.3</span></span><br><span class="line"><span class="keyword">ELSE</span> salary</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> 最终工资</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>



<p><strong>第二种用法类似多层if，</strong>语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">case </span><br><span class="line"></span><br><span class="line">when condition1 then 要显示的值1或语句1;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">when condition_n then 要显示的值n或语句n;</span><br><span class="line"></span><br><span class="line">else 默认显示</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--嵌套在select中使用</span></span><br><span class="line"><span class="comment">--根据工资的大小区间分多个工资级别：</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,</span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;<span class="number">20000</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;<span class="number">15000</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;<span class="number">10000</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> 工资级别</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">--在存储过程中使用</span></span><br><span class="line"><span class="comment">--根据工资显示工资级别</span></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> testcase(<span class="keyword">IN</span> score <span class="built_in">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">CASE</span></span><br><span class="line">	<span class="keyword">WHEN</span> score&gt;=<span class="number">90</span> <span class="keyword">AND</span> score&lt;=<span class="number">100</span> <span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">	WHEN score&gt;=80 THEN SELECT &#x27;B&#x27;;</span><br><span class="line">	WHEN score&gt;=60 THEN SELECT &#x27;C&#x27;;</span><br><span class="line">	ELSE <span class="keyword">SELECT</span> <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">	<span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="keyword">END</span> $ </span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> testcase(<span class="number">95</span>);</span><br></pre></td></tr></table></figure>



<p>两种case-when的特点：</p>
<ul>
<li><strong>可以作为表达式， 嵌套在其他语句中使用（此时整个CASE-WHEN执行完毕后返回一个值，如第一种用法的例子）</strong>；可以作为独立的语句，但必须放在begin-end中。</li>
<li><strong>如果WHEN中的值满足或条件成立， 则执行对应的THEN后面的语句，并且结束CASE</strong>。如果都不满足， 则执行ELSE中的语句或值。</li>
<li>ELSE可以省略， 如果ELSE省略了， <strong>并且所有WHEN条件都不满足， 则返回NULL</strong>。</li>
</ul>
<h4 id="if结构"><a href="#if结构" class="headerlink" title="if结构"></a>if结构</h4><p><strong>if结构只能使用在begin-end中</strong>。</p>
<p>语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IF search_condition THEN statement_list   </span><br><span class="line">ELSEIF search_condition THEN statement_list</span><br><span class="line">...</span><br><span class="line">[ELSE statement_list;]</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">IF</span>;</span><br></pre></td></tr></table></figure>



<h3 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- while循环</span></span><br><span class="line">[label_name:] while 循环条件 <span class="keyword">do</span></span><br><span class="line">    循环体;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">while</span> [label_name];</span><br><span class="line">- 如果需要在循环内提前终止 while循环，则需要使用标签；标签需要成对出现。</span><br><span class="line">	<span class="comment">-- 退出循环</span></span><br><span class="line">		退出整个循环 leave label_name;</span><br><span class="line">		退出当前循环 iterate label_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--loop循环</span></span><br><span class="line">[label_name:] loop</span><br><span class="line">    循环体;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">loop</span> [label_name];</span><br><span class="line">	<span class="comment">--需搭配leave和iterate，否则会死循环</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--repeat</span></span><br><span class="line">[label_name:] repeat</span><br><span class="line">    循环体;</span><br><span class="line">until 结束循环的条件</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">repeat</span> [label_name];</span><br></pre></td></tr></table></figure>

















</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">bxxiao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2020/07/17/MySQL%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/">http://example.com/2020/07/17/MySQL%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">bxxiao</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/Tag/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/bxgitee/noteImage/raw/master/image/ball_glass_sunset_133830_1920x1080.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2020/11/01/Java%20IO%E6%80%BB%E7%BB%93/"><img class="prev-cover" src="https://gitee.com/bxgitee/noteImage/raw/master/image/wallhaven-9mxz8k.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Java IO总结</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://gitee.com/bxgitee/noteImage/raw/master/image/567.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">bxxiao</div><div class="author-info__description">弹指间、数据库灰飞烟灭</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">10</div></a></div><div class="card-info-data-item is-center"><a href="/Tag/"><div class="headline">标签</div><div class="length-num">6</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/bxxiao"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%9A%84%E5%8D%B8%E8%BD%BD%E5%8F%8A%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">MySQL的卸载及安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E5%8D%B8%E8%BD%BD"><span class="toc-number">2.1.</span> <span class="toc-text">MySQL卸载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL8-0-22%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">2.2.</span> <span class="toc-text">MySQL8.0.22的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#my-ini%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">my.ini文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E5%85%B3%E9%97%AD"><span class="toc-number">3.</span> <span class="toc-text">MySQL服务的启动和关闭</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%99%BB%E5%BD%95MySQL%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">4.</span> <span class="toc-text">登录MySQL及环境变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95MySQL"><span class="toc-number">4.1.</span> <span class="toc-text">登录MySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">4.2.</span> <span class="toc-text">MySQL环境变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E8%AF%AD%E6%B3%95%E8%A7%84%E8%8C%83%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">5.</span> <span class="toc-text">MySQL语法规范及常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E8%A7%84%E8%8C%83"><span class="toc-number">5.1.</span> <span class="toc-text">语法规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">5.2.</span> <span class="toc-text">常用命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-DQL"><span class="toc-number">6.</span> <span class="toc-text">MySQL基础-DQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.1.</span> <span class="toc-text">基础查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.2.</span> <span class="toc-text">条件查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%AD%9B%E9%80%89"><span class="toc-number">6.2.1.</span> <span class="toc-text">按条件表达式筛选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%AD%9B%E9%80%89"><span class="toc-number">6.2.2.</span> <span class="toc-text">按逻辑表达式筛选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.2.3.</span> <span class="toc-text">模糊查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.3.</span> <span class="toc-text">排序查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.4.</span> <span class="toc-text">分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%90%8E%E7%AD%9B%E9%80%89-having%E5%AD%90%E5%8F%A5"><span class="toc-number">6.4.1.</span> <span class="toc-text">分组后筛选(having子句)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.5.</span> <span class="toc-text">连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5-%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.5.1.</span> <span class="toc-text">内连接-等值连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5-%E9%9D%9E%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.5.2.</span> <span class="toc-text">内连接-非等值连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5-%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.5.3.</span> <span class="toc-text">内连接-自连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.5.4.</span> <span class="toc-text">外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.5.5.</span> <span class="toc-text">交叉连接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.6.</span> <span class="toc-text">子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#where-having%E5%90%8E%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.6.1.</span> <span class="toc-text">where&#x2F;having后的子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#select%E5%90%8E%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.6.2.</span> <span class="toc-text">select后的子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#from%E5%90%8E%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.6.3.</span> <span class="toc-text">from后的子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exists%E5%90%8E%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.6.4.</span> <span class="toc-text">exists后的子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%EF%BC%88Limit%EF%BC%89"><span class="toc-number">6.7.</span> <span class="toc-text">分页查询（Limit）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.8.</span> <span class="toc-text">联合查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-DML"><span class="toc-number">7.</span> <span class="toc-text">MySQL基础-DML</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%EF%BC%88insert%EF%BC%89"><span class="toc-number">7.1.</span> <span class="toc-text">插入（insert）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%EF%BC%88update%EF%BC%89"><span class="toc-number">7.2.</span> <span class="toc-text">更新（update）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%EF%BC%88delete%EF%BC%89"><span class="toc-number">7.3.</span> <span class="toc-text">删除（delete）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-DDL"><span class="toc-number">8.</span> <span class="toc-text">MySQL基础-DDL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%93%E7%9A%84%E7%AE%A1%E7%90%86"><span class="toc-number">8.1.</span> <span class="toc-text">库的管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E7%AE%A1%E7%90%86"><span class="toc-number">8.2.</span> <span class="toc-text">表的管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">8.2.1.</span> <span class="toc-text">1.表的创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%A1%A8%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">8.2.2.</span> <span class="toc-text">2.表的修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%A1%A8%E7%9A%84%E5%88%A0%E9%99%A4"><span class="toc-number">8.2.3.</span> <span class="toc-text">3.表的删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%A1%A8%E7%9A%84%E5%A4%8D%E5%88%B6"><span class="toc-number">8.2.4.</span> <span class="toc-text">4.表的复制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%A1%A8%E7%9A%84%E9%80%89%E9%A1%B9-%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">8.2.5.</span> <span class="toc-text">5.表的选项&#x2F;查看表结构</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">9.</span> <span class="toc-text">MySQL基础-数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E5%9E%8B"><span class="toc-number">9.1.</span> <span class="toc-text">整型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E6%95%B0"><span class="toc-number">9.2.</span> <span class="toc-text">小数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B"><span class="toc-number">9.3.</span> <span class="toc-text">字符型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B"><span class="toc-number">9.4.</span> <span class="toc-text">日期类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#timestamp%E5%92%8Cdatetime"><span class="toc-number">9.4.1.</span> <span class="toc-text">timestamp和datetime</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-%E7%BA%A6%E6%9D%9F"><span class="toc-number">10.</span> <span class="toc-text">MySQL基础-约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">10.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PRIMARY-KEY%E5%92%8CUNIQUE"><span class="toc-number">10.2.</span> <span class="toc-text">PRIMARY KEY和UNIQUE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%A4%96%E9%94%AE"><span class="toc-number">10.3.</span> <span class="toc-text">关于外键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8Eauto-increment"><span class="toc-number">10.4.</span> <span class="toc-text">关于auto_increment</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-%E4%BA%8B%E5%8A%A1"><span class="toc-number">11.</span> <span class="toc-text">MySQL基础-事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">11.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E7%89%A9%E7%9A%84%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7-ACID"><span class="toc-number">11.2.</span> <span class="toc-text">事物的四大特性(ACID)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">11.3.</span> <span class="toc-text">事务的创建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E6%BB%9A%E7%82%B9SAVEPOINT"><span class="toc-number">11.3.1.</span> <span class="toc-text">回滚点SAVEPOINT</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="toc-number">11.4.</span> <span class="toc-text">事务并发问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E7%9A%84%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">11.5.</span> <span class="toc-text">MySQL的事务隔离级别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%81%E6%9C%BA%E5%88%B6%E4%B8%8EInnoDB%E9%94%81%E7%AE%97%E6%B3%95%EF%BC%88to-be-continue%EF%BC%89"><span class="toc-number">11.6.</span> <span class="toc-text">锁机制与InnoDB锁算法（to be continue）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-%E8%A7%86%E5%9B%BE"><span class="toc-number">12.</span> <span class="toc-text">MySQL基础-视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="toc-number">12.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">12.2.</span> <span class="toc-text">视图的创建和使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">12.3.</span> <span class="toc-text">视图的修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E5%88%A0%E9%99%A4%E5%92%8C%E6%9F%A5%E7%9C%8B"><span class="toc-number">12.4.</span> <span class="toc-text">视图的删除和查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E6%9B%B4%E6%96%B0"><span class="toc-number">12.5.</span> <span class="toc-text">视图更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E4%B8%8E%E8%A1%A8"><span class="toc-number">12.6.</span> <span class="toc-text">视图与表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-%E5%8F%98%E9%87%8F"><span class="toc-number">13.</span> <span class="toc-text">MySQL基础-变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">13.1.</span> <span class="toc-text">系统变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">13.2.</span> <span class="toc-text">自定义变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">14.</span> <span class="toc-text">MySQL基础-存储过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-%E5%87%BD%E6%95%B0"><span class="toc-number">15.</span> <span class="toc-text">MySQL基础-函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.</span> <span class="toc-text">自定义函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-number">15.2.</span> <span class="toc-text">内置函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0-%E5%AD%97%E7%AC%A6%E5%87%BD%E6%95%B0"><span class="toc-number">15.2.1.</span> <span class="toc-text">单行函数-字符函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0-%E6%95%B0%E5%AD%97%E5%87%BD%E6%95%B0"><span class="toc-number">15.2.2.</span> <span class="toc-text">单行函数-数字函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0-%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">15.2.3.</span> <span class="toc-text">单行函数-日期函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0-%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0"><span class="toc-number">15.2.4.</span> <span class="toc-text">单行函数-其他函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%87%BD%E6%95%B0"><span class="toc-number">15.2.5.</span> <span class="toc-text">单行函数-流程控制函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-number">15.2.6.</span> <span class="toc-text">分组函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">16.</span> <span class="toc-text">MySQL基础-流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84"><span class="toc-number">16.1.</span> <span class="toc-text">分支结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if%E5%87%BD%E6%95%B0"><span class="toc-number">16.1.1.</span> <span class="toc-text">if函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#case-when"><span class="toc-number">16.1.2.</span> <span class="toc-text">case..when</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#if%E7%BB%93%E6%9E%84"><span class="toc-number">16.1.3.</span> <span class="toc-text">if结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="toc-number">16.2.</span> <span class="toc-text">循环结构</span></a></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2020/11/13/Spring%E4%B8%AD%E5%A4%84%E7%90%86json%E6%95%B0%E6%8D%AE/" title="Spring中处理json数据的总结"><img src="https://gitee.com/bxgitee/noteImage/raw/master/image/ball_glass_sunset_133830_1920x1080.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring中处理json数据的总结"/></a><div class="content"><a class="title" href="/2020/11/13/Spring%E4%B8%AD%E5%A4%84%E7%90%86json%E6%95%B0%E6%8D%AE/" title="Spring中处理json数据的总结">Spring中处理json数据的总结</a><time datetime="2020-11-12T16:45:26.199Z" title="发表于 2020-11-13 00:45:26">2020-11-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/12/%E4%BD%BF%E7%94%A8mybatis%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%80%E4%B8%AA%E5%BC%82%E5%B8%B8/" title="使用Mybatis逆向工程所生成的mapper接口时出现异常"><img src="https://gitee.com/bxgitee/noteImage/raw/master/image/ball_glass_sunset_133830_1920x1080.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用Mybatis逆向工程所生成的mapper接口时出现异常"/></a><div class="content"><a class="title" href="/2020/11/12/%E4%BD%BF%E7%94%A8mybatis%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%80%E4%B8%AA%E5%BC%82%E5%B8%B8/" title="使用Mybatis逆向工程所生成的mapper接口时出现异常">使用Mybatis逆向工程所生成的mapper接口时出现异常</a><time datetime="2020-11-12T11:06:19.291Z" title="发表于 2020-11-12 19:06:19">2020-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/05/%E8%B7%AF%E5%BE%84%E4%B8%AD%E6%96%9C%E6%9D%86%E3%80%81%E5%8F%8D%E6%96%9C%E6%9D%A0%E7%9A%84%E5%8C%BA%E5%88%AB/" title="路径中斜杆、反斜杠的区别"><img src="https://gitee.com/bxgitee/noteImage/raw/master/image/preview1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="路径中斜杆、反斜杠的区别"/></a><div class="content"><a class="title" href="/2020/11/05/%E8%B7%AF%E5%BE%84%E4%B8%AD%E6%96%9C%E6%9D%86%E3%80%81%E5%8F%8D%E6%96%9C%E6%9D%A0%E7%9A%84%E5%8C%BA%E5%88%AB/" title="路径中斜杆、反斜杠的区别">路径中斜杆、反斜杠的区别</a><time datetime="2020-11-05T05:37:07.900Z" title="发表于 2020-11-05 13:37:07">2020-11-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/04/SSM%E6%95%B4%E5%90%88Demo/" title="SSM整合"><img src="https://gitee.com/bxgitee/noteImage/raw/master/image/preview1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SSM整合"/></a><div class="content"><a class="title" href="/2020/11/04/SSM%E6%95%B4%E5%90%88Demo/" title="SSM整合">SSM整合</a><time datetime="2020-11-04T11:15:09.875Z" title="发表于 2020-11-04 19:15:09">2020-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/04/Mybatis%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/" title="Mybatis逆向工程"><img src="https://gitee.com/bxgitee/noteImage/raw/master/image/preview1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mybatis逆向工程"/></a><div class="content"><a class="title" href="/2020/11/04/Mybatis%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/" title="Mybatis逆向工程">Mybatis逆向工程</a><time datetime="2020-11-04T10:33:15.236Z" title="发表于 2020-11-04 18:33:15">2020-11-04</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://gitee.com/bxgitee/noteImage/raw/master/image/blogImagec.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 By bxxiao</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>